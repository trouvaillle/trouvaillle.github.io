---
layout: post
title: "AI Engineering: Chapter 7, 8"
date: 2025-03-02 12:00:00 +0900
categories: study ai-engineering
comments: true
visible: true
---
[AI Engineering by Chip Huyen](https://www.oreilly.com/library/view/ai-engineering/9781098166298/)

## Chapter 7
Finetuning: νμΈνλ‹

- <mark>νμΈνλ‹μ€ λ¨λΈμ μ „μ²΄ λλ” μΌλ¶€λ¥Ό μ¶”κ°€μ μΌλ΅ ν•™μµμ‹μΌμ„ νΉμ • μ‘μ—…μ— μ μ‘<small>adapt</small>μ‹ν‚¤λ” κ³Όμ •μ„ λ§ν•λ‹¤.</mark>
    - λ¨λΈμ κ°€μ¤‘μΉλ¥Ό μ΅°μ •ν•λ‹¤.
- λ¨λΈμ λ„λ©”μΈ νΉν™” κΈ°λ¥μ„ ν–¥μƒμ‹ν‚¬ μ μλ‹¤.
    - μ½”λ”©μ΄λ‚ μν•™ μ§μμ‘λ‹µ
- λ¨λΈμ μ•μ „μ„±μ„ κ°•ν™”ν•  μ μλ‹¤.
- λ€λ¶€λ¶„ λ¨λΈμ μ§€μ‹ μν–‰ λ¥λ ¥μ„ ν–¥μƒμ‹ν‚¤λ”λ° μ‚¬μ©λλ‹¤. νΉν νΉμ • μ¶λ ¥ μ¤νƒ€μΌμ΄λ‚ ν•μ‹μ— μ¤€μν•λ„λ΅ ν•κΈ° μ„ν•΄ ν™μ©λλ‹¤.
- μ–Έμ  νμΈνλ‹ λλ” RAGλ¥Ό ν•΄μ•Όν• μ§€λ” ν”ν• μ§λ¬Έμ΄λ‹¤.
- ν”„λ΅¬ν”„νΈ κΈ°λ° λ°©λ²•κ³Ό λ‹¤λ¥΄κ² <mark>νμΈνλ‹μ€ ν›¨μ”¬ λ§μ€ λ©”λ¨λ¦¬ λ°μκµ­</mark>μ„ μ λ°ν•λ‹¤.
    - λ§μ€ νμΈνλ‹ κΈ°μ λ“¤μ€ λ©”λ¨λ¦¬ μ”κµ¬λ‰μ„ μ¤„μ΄λ” κ²ƒμ— μ°©μ•ν•μ—¬ κ°λ°λλ‹¤.
- <mark><i>PEFT</i><small>parameter-efficient finetunig</small>λ” λ©”λ¨λ¦¬ ν¨μ¨μ μΈ μ ‘κ·Ό</mark>μΌλ΅ νμΈνλ‹ μμ—­μ—μ„ μ§€λ°°μ μ΄λμ—λ‹¤.
    - PEFTμ—μ„λ” νΉν adpater-based κΈ°μ μ„ μ‚΄ν΄λ³Έλ‹¤.

### νμΈνλ‹ κ°μ”
- νμΈνλ‹μ€ ν•„μ”ν• λ¥λ ¥μ„ κ°€μ§„ λ² μ΄μ¤ λ¨λΈλ΅ μ‹μ‘ν•λ‹¤.
- <mark>νμΈνλ‹μ λ©ν‘λ” λ² μ΄μ¤ λ¨λΈμ„ νΉμ • μ‘μ—…μ„ λ” μ μν–‰ν•λ„λ΅ λ§λ“λ” κ²ƒμ΄λ‹¤.</mark>
- νμΈνλ‹μ€ μ „μ΄ ν•™μµ<small>transfer learning</small>μ ν• λ°©λ²•μ΄λ‹¤.
    - μ „μ΄ ν•™μµμ€ Bozinovβ€skiμ™€ Fulgosiμ— μν•΄ 1976λ…„ μ²μ μ†κ°λμ—λ‹¤.
    - μ „μ΄ ν•™μµμ€ ν• μ‘μ—…μ—μ„ μ–»μ–΄μ§„ μ§€μ‹μ„ μƒλ΅μ΄ μ‘μ—…μ ν•™μµ κ°€μ†μ„ μ„ν•΄ μ „μ΄ν•λ” λ°©λ²•μ— μ§‘μ¤‘ν•λ‹¤.
    - ν”Όμ•„λ…Έλ¥Ό μΉ  μ¤„ μ•„λ” μ‚¬λμ΄ λ‹¤λ¥Έ μ•…κΈ°λ¥Ό λ” μ‰½κ² λ‹¤λ£¨λ” κ²ƒκ³Ό λΉ„μ·ν•λ‹¤.
- λ”¥λ¬λ‹ μ΄μ°½κΈ° λ™μ• μ „μ΄ ν•™μµμ€ μ ν•λκ±°λ‚ κ°’λΉ„μ‹Ό ν›λ ¨ λ°μ΄ν„°λ¥Ό μ§€λ‹ μ‘μ—…μ— λ€ν• ν•΄κ²°μ±…μ„ μ μ‹ν–λ‹¤.
- LLMμ—μ„ ν…μ¤νΈ μ™„μ„±μ„ μ„ν• μ‚¬μ „ ν•™μµμ—μ„ μ–»μ–΄μ§„ μ§€μ‹μ€ νΉν™”λ μ‘μ—…μΈ λ²•λ¥  μ§μμ‘λ‹µμ΄λ‚ text-to-SQLλ΅ μ „μ΄λ  μ μλ‹¤.
    - μ „μ΄ ν•™μµμ λ¥λ ¥μ€ νμ΄λ°μ΄μ… λ¨λΈμ„ λ” κ°€μΉμκ² λ§λ“¤ μ μλ‹¤.
- <mark>μ „μ΄ ν•™μµμ€ μƒν” ν¨μ¨μ„±<small>sample efficiency</small>λ¥Ό ν–¥μƒμ‹ν‚¤κ³  λ¨λΈμ€ λ” μ μ€ μμ λ΅ κ°™μ€ ν–‰λ™μ„ ν¨κ³Όμ μΌλ΅ λ°°μ°κ² ν•  μ μλ‹¤.</mark>
    - μλ¥Ό λ“¤μ–΄, λ²•λ¥  μ§μμ‘λ‹µ λ¨λΈμ„ μ²μλ¶€ν„° λ§λ“λ ¤λ©΄ 100λ§κ°μ μμ κ°€ ν•„μ”ν•κ² μ§€λ§, μΆ‹μ€ λ² μ΄μ¤ λ¨λΈμ„ νμΈνλ‹ν•  λ•λ” μλ°±κ°μ μμ λ΅ μ¶©λ¶„ν•λ‹¤.
- <mark>μ΄μƒμ μΌλ΅ λ³΄λ©΄, λ¨λΈμ΄ λ°°μ›μ•Ό ν•  λ§μ€ λ‚΄μ©μ€ μ΄λ―Έ λ² μ΄μ¤ λ¨λΈμ— ν¬ν•¨λμ–΄ μμΌλ©°, νμΈνλ‹μ€ λ¨λΈμ ν–‰λ™μ„ λ‹¤λ“¬λ” μ—­ν• μ„ ν•λ‹¤.</mark>
    - OpenAIμ [InstructGPT (2022)](https://arxiv.org/abs/2203.02155)μ—μ„λ” λ¨λΈμ΄ μ΄λ―Έ κ°€μ§€κ³  μμΌλ‚ μ‚¬μ©μλ“¤μ΄ ν”„λ΅¬ν”„ν…λ§μΌλ΅λ” μ ‘κ·Όν•κΈ° μ–΄λ ¤μ΄ λ¥λ ¥μ„ νμΈνλ‹μ΄ μ κΈ ν•΄μ ν•λ‹¤λ” κ΄€μ μ„ μ μ•ν•λ‹¤.
<aside mark="π’΅">
μ „μ΄ ν•™μµμ€ νμΈνλ‹ λΏλ§ μ•„λ‹λΌ νΉμ§• κΈ°λ° μ „μ΄<small>feature-based transfer</small>λ΅λ„ κ°€λ¥ν•λ‹¤.<br/>
νΉμ§• κΈ°λ° μ „μ΄μ—μ„λ” λ¨λΈμ΄ λ°μ΄ν„°λ΅λ¶€ν„° νΉμ§•μ„ μ¶”μ¶ν•κ³  λ‹¤λ¥Έ λ¨λΈμ—μ„ μ΄λ¥Ό μ΄μ©ν•λ‹¤.<br/>
νΉμ§• κΈ°λ° μ „μ΄μ μλ΅, νμ΄λ°μ΄μ… λ¨λΈμ€ λ¶„λ¥ ν—¤λ“<small>classifier head</small>λ¥Ό μ¶”κ°€ν•μ—¬ λ¶„λ¥ μ‘μ—…μ— μ¬μ‚¬μ©λ  μ μλ‹¤.
</aside>
- νμΈνλ‹μ€ λ¨λΈ ν•™μµ κ³Όμ •μ μΌλ¶€μ΄λ©°, μ‚¬μ „ ν•™μµμ ν™•μ¥μ΄λ‹¤.
    - νμΈνλ‹μ€ μ‚¬μ „ ν•™μµ μ΄ν›„μ λ¨λ“  ν›λ ¨μ„ μλ―Έν•λ‹¤.
- λ¨λΈ ν›λ ¨ κ³Όμ •μ€ μ‚¬μ „ ν•™μµμΌλ΅ μ‹μ‘λλ©° μκΈ° μ§€λ„<small>self-supervision</small>λ΅ μ΄λ£¨μ–΄μ§„λ‹¤.
    - μκΈ° μ§€λ„λ” λ¨λΈμ΄ λ μ΄λΈ”λμ§€ μ•μ€ λ‹¤λ‰μ λ°μ΄ν„°λ΅λ¶€ν„° ν•™μµν•  μ μλ„λ΅ ν•λ‹¤.
    - μ–Έμ–΄ λ¨λΈμ—μ„ μκΈ° μ§€λ„ λ°μ΄ν„°λ” μ£Όμ„μ΄ ν•„μ”μ—†λ” ν…μ¤νΈμ λ‚μ—΄μ„ μλ―Έν•λ‹¤.
- <mark>κ°’λΉ„μ‹Ό μ‘μ—… νΉν™” λ°μ΄ν„°λ΅ νμΈνλ‹ν•κΈ° μ „μ—, μ €λ ΄ν• μ‘μ—… μ—°κ΄€ λ°μ΄ν„°λ΅ μκΈ° μ§€λ„ νμΈνλ‹μ„ ν•  μ μλ‹¤.</mark>
    - μλ¥Ό λ“¤μ–΄, λ²•λ¥  μ§μμ‘λ‹µμ κ²½μ° λ‚  κ²ƒμ λ²•λ¥  λ¬Έμ„λ΅ νμΈνλ‹ν•  μ μλ‹¤.
    - λ¨λΈμ΄ λ² νΈλ‚¨μ–΄λ΅ μ±… μ”μ•½μ„ ν•λ„λ΅ νμΈνλ‹ν•λ ¤λ©΄ λ§μ€ λ² νΈλ‚¨μ–΄ ν…μ¤νΈλ΅ λ¨Όμ € μΈνλ‹ν•  μ μλ‹¤.
- μκΈ° μ§€λ„ νμΈνλ‹<small>self-supervised finetuning</small>μ€ κ³„μ†λ μ‚¬μ „ ν•™μµ<small>continued pre-traning</small>μ΄λΌκ³ λ„ λ¶λ¦°λ‹¤.
- μ§€λ„ νμΈνλ‹<small>supervised finetuning</small>μ„ ν†µν•΄ λ¨λΈμ΄ λ‹¤μ ν† ν°μ΄λ‚ λΉ μΉΈμ„ μ±„μ°λ„λ΅ νμΈνλ‹ν•  μ μλ‹¤.
    - ν›„μλ” λΉ μΉΈ μ±„μ°κΈ° νμΈνλ‹<small>infilling finetuning</small>μ΄λ©° ν…μ¤νΈ νΈμ§‘μ΄λ‚ μ½”λ“ λ””λ²„κΉ… κ°™μ€ μ‘μ—…μ— νΉν μ μ©ν•λ‹¤. 
    - λ¨λΈμ΄ μκΈ°νκ·€μ <small>autoregressively</small>μΌλ΅ μ‚¬μ „ ν•™μµλμ—λ”λΌλ„ λΉ μΉΈ μ±„μ°κΈ° νμΈνλ‹μ„ ν•  μ μλ‹¤.
- <mark>μ§€λ„ νμΈνλ‹μ€ κ³ ν’μ§μ μ£Όμ„μ΄ λ‹¬λ¦° λ°μ΄ν„°λ¥Ό μ‚¬μ©ν•μ—¬ λ¨λΈμ„ μΈκ°„μ μ‚¬μ© λ°©μ‹κ³Ό μ„ νΈλ„μ— λ§κ² λ‹¤λ“¬λ”λ‹¤.</mark>
- <mark>μ§€λ„ νμΈνλ‹ λ™μ• λ¨λΈμ€ (μ…λ ¥, μ¶λ ¥) μμΌλ΅ ν›λ ¨λλ‹¤.</mark>
    - μ…λ ¥μ€ μ§€μ‹, μ¶λ ¥μ€ λ‹µλ³€μ΄ λ  μ μλ‹¤.
- λ‹µλ³€μ€ μ±… μ”μ•½μ²λΌ μ—΄λ¦° κ²°λ§<small>open-ended</small>μ΄κ±°λ‚ λ¶„λ¥ μ‘μ—…μ²λΌ λ‹«ν κ²°λ§<small>close-ended</small>μΌ μ μλ‹¤.
- κ³ ν’μ§ μ§€μ‹ λ°μ΄ν„°λ” λ§λ“¤κΈ° μ–΄λ µκ³  λΉ„μ€ μ μλ‹¤. νΉν μ‚¬μ‹¤μ  μΌκ΄€μ„±, λ„λ©”μΈ μ „λ¬Έκ°€, μ •μΉμ  μ¬λ°”λ¦„μ„ μ”κµ¬ν•λ” μ§€μ‹μΌ κ²½μ° λ” κ·Έλ ‡λ‹¤.
- <mark>λ¨λΈμ€ μ‚¬λμ μ„ νΈλ„λ¥Ό μµλ€ν™”ν•  μ μλ” λ‹µλ³€μ„ μƒμ„±ν•λ„λ΅ κ°•ν™” ν•™μµμΌλ΅ νμΈνλ‹λ  μ μλ‹¤.</mark>
    - <mark>μ„ νΈλ„ νμΈνλ‹<small>preference finetuning</small>μ€ μ£Όλ΅ (μ§€μ‹, μ΄κΈ΄ λ‹µλ³€, μ§„ λ‹µλ³€)μ ν•μ‹μ„ λ”°λ¥΄λ” λΉ„κµ λ°μ΄ν„°λ¥Ό ν•„μ”λ΅ ν•λ‹¤.</mark>
- <mark>μ»¨ν…μ¤νΈ κΈΈμ΄λ¥Ό λλ¦¬κΈ° μ„ν•΄ λ¨λΈμ„ νμΈνλ‹ν•  μ μλ‹¤.</mark>
    - κΈ΄ μ»¨ν…μ¤νΈ νμΈνλ‹<small>long-context finetuning</small>μ€ μ£Όλ΅ λ¨λΈμ κµ¬μ΅°λ¥Ό μμ •ν•  ν•„μ”κ°€ μλ‹¤. μΌλ΅€λ΅, μ„μΉ μ„λ² λ”©<small>positional embedding</small>μ„ μ΅°μ •ν•΄μ•Ό ν•λ‹¤.
    - κΈ΄ μ‹ν€€μ¤λ” ν† ν°μ΄ λ” λ§μ€ κ°€λ¥ν• μ„μΉλ¥Ό κ°€μ§„λ‹¤λ” κ²ƒμ΄κ³ , μ„μΉ μ„λ² λ”©μ€ μ΄λ¥Ό μ²λ¦¬ν•  μ μμ–΄μ•Ό ν•λ‹¤.
    - κΈ΄ μ»¨ν…μ¤νΈ νμΈνλ‹μ€ λ‹¤λ¥Έ νμΈνλ‹λ³΄λ‹¤ μν–‰ν•κΈ° μ–΄λ µκ³ , κ²°κ³Ό λ¨λΈμ€ μ§§μ€ μ‹ν€€μ¤μ— λ€ν•΄ ν’μ§μ΄ μ €ν•λ  μ μλ‹¤.
- λ¨λΈ κ°λ°μλ” λ‹¤λ¥Έ λ©μ μΌλ΅ νμΈνλ‹λ μ—¬λ¬ λ¨λΈ λ²„μ „μ„ μ¶μ‹ν•  μ μμΌλ©°, μ• ν”λ¦¬μΌ€μ΄μ… κ°λ°μλ” μ ν•©ν• λ¨λΈμ„ μ„ νƒν•  μ μλ‹¤.

<div style="text-align: center;"><img src="{{ "/assets/img/posts/study/ai-engineering/chapter7-8/figure7-1.png" | relative_url }}" width="540px"/><p>Code Llama λ¨λΈμ— μ μ©λ μ—¬λ¬ νμΈνλ‹ κΈ°μ λ“¤</p></div>

### μ–Έμ  νμΈνλ‹μ„ ν•΄μ•Όν• κΉ?
νμΈνλ‹κ³Ό ν”„λ΅¬ν”„ν…μ€ μƒνΈ λ°°νƒ€μ μΈ μ ‘κ·Όμ΄ μ•„λ‹λΌ, ν„μ‹¤ μ„Έκ³„μ λ¬Έμ λ¥Ό ν’€κΈ° μ„ν•΄ μΆ…μΆ… ν•¨κ» μ‚¬μ©λμ–΄μ•Ό ν•λ‹¤.

#### νμΈνλ‹ν•  μ΄μ 
- νμΈνλ‹ν•  μ£Όλ μ΄μ λ” λ¨λΈμ ν’μ§μ„ ν–¥μƒμ‹ν‚¤κΈ° μ„ν•¨μ΄λ‹¤.<br/>
    μ—¬κΈ°μ„ ν’μ§μ΄λ€ μ „λ°μ μΈ λ¨λΈμ λ¥λ ¥κ³Ό μ‘μ—… νΉν™”μ μΈ λ¥λ ¥μ„ μλ―Έν•λ‹¤.

- νΉν ν¥λ―Έλ΅μ΄ νμΈνλ‹ μ©λ΅€λ” νΈκ²¬ μ κ±°λ‹¤. λ² μ΄μ¤ λ¨λΈμ΄ ν›λ ¨ λ°μ΄ν„°λ΅λ¶€ν„° μ–΄λ–¤ νΈκ²¬μ„ μμ†ν•κ³  μμΌλ©΄, μ„Έμ‹¬ν•κ² μ„ μ •λ λ°μ΄ν„°λ¥Ό λ…Έμ¶μ‹ν‚¤λ” λ°©μ‹μΌλ΅ νμΈνλ‹μ„ μ§„ν–‰ν•λ©΄ ν•΄λ‹Ή νΈκ²¬μ„ μƒμ‡„μ‹ν‚¬ μ μλ‹¤.
    - [Garimella et al. (2022)](https://aclanthology.org/2022.aacl-short.38/)λ” μ—¬μ„±μ΄ μ‘μ„±ν• κΈ€μ΄ λ¨λΈμ μ„±λ³„ νΈκ²¬μ„ μ κ±°ν•κ³ , μ•„ν”„λ¦¬μΉΈ μ‘μ„±μκ°€ μ“΄ κΈ€μ΄ μΈμΆ… νΈκ²¬μ„ μ κ±°ν•  μ μμμ„ λ°κ²¬ν–λ‹¤.
- κ³µν†µμ μΈ μ ‘κ·Ό λ°©λ²•μ„ <mark>λ” ν° λ¨λΈλ΅λ¶€ν„° μƒμ„±λ λ°μ΄ν„°λ¥Ό ν†µν•΄ λ” ν° λ¨λΈμ ν–‰λ™μ„ μ‘μ€ λ¨λΈμ΄ λ¨λ°©ν•λ„λ΅ νμΈνλ‹ν•λ” κ²ƒμ΄λ‹¤.</mark>
    - *μ¦λ¥<small>distillation</small>*λΌλ” λ°©λ²•μΌλ΅ λ€ν• λ¨λΈμ μ§€μ‹μ„ μ‘μ€ λ¨λΈλ΅ μ¦λ¥ν•λ” μ ‘κ·Ό λ°©λ²•μ΄λ‹¤.
- <mark>νΉμ • μ‘μ—…μ— λ€ν•΄ νμΈνλ‹λ μ‘μ€ λ¨λΈμ€ κ°€λ” ν›¨μ”¬ ν° μ΄κΈ° μƒνƒμ λ¨λΈλ³΄λ‹¤ ν•΄λ‹Ή μ‘μ—…μ„ μ μν–‰ν•  μ μλ‹¤.</mark>

#### νμΈνλ‹ν•μ§€ μ•μ„ μ΄μ 
- νμΈνλ‹μ€ λ¨λΈμ μ„±λ¥μ„ ν–¥μƒμ‹ν‚¬ μ μμ§€λ§ <mark>μ„¬μ„Έν•κ² μ‘μ„±λ ν”„λ΅ν””ν”„νΈμ™€ μ»¨ν…μ¤νΈλ„ μ„±λ¥ ν–¥μƒμ— κΈ°μ—¬ν•  μ μλ‹¤.</mark>
- λ¨Όμ €, <mark>λ¨λΈμ„ νΉμ • μ‘μ—…μ— νμΈνλ‹ν•λ©΄ ν•΄λ‹Ή μ‘μ—…μ— λ€ν• μ„±λ¥μ„ ν–¥μƒμ‹ν‚¬ μ μμ§€λ§, λ‹¤λ¥Έ μ‘μ—…μ— λ€ν• μ„±λ¥μ„ μ•½ν™”μ‹ν‚¬ μ μλ‹¤.</mark>
μ΄λ° κ²½μ° μ„λ΅ λ‹¤λ¥Έ μ‘μ—…μ— λ¶„λ¦¬λ λ¨λΈμ„ μ‚¬μ©ν•λ” κ²ƒμ„ κ³ λ ¤ν•΄λ³Ό μ μλ‹¤.
    - ν”„λ΅μ νΈλ¥Ό μ„ν• μ‹¤ν—μ μ‹μ‘μΌλ΅ νμΈνλ‹μ„ μ‚¬μ©ν•κΈ°λ” μ–΄λ µλ‹¤. νμΈνλ‹μ—λ” λ¨Όμ € λ°μ΄ν„°κ°€ ν•„μ”ν•κ³ , μ£Όμ„μ²λ¦¬λ λ°μ΄ν„°λ” μλ™μΌλ΅ μ–»κΈ°μ— λλ¦¬κ³  λΉ„μ‹Έλ‹¤. νΉν λΉ„νμ  μ‚¬κ³ μ™€ λ„λ©”μΈ μ „λ¬Έ μ§€μ‹μ„ μ”κµ¬ν•λ” μ‘μ—…μ κ²½μ° λ” κ·Έλ ‡λ‹¤. μ¤ν” μ†μ¤ λ°μ΄ν„°μ™€ AIλ΅ μƒμ„±λ λ°μ΄ν„°κ°€ λΉ„μ©μ„ μ¤„μ—¬μ¤„ μ μμ§€λ§, κ·Έ ν¨κ³Όμ„±μ€ λ§¤μ° λ³€λ™μ μ΄λ‹¤.
- λ‘λ²μ§Έλ΅, νμΈνλ‹μ€ λ¨λΈμ„ ν›λ ¨ν•λ” λ°©λ²•μ— λ€ν• μ§€μ‹μ„ ν•„μ”λ΅ ν•λ‹¤. 
- μ„Έλ²μ§Έλ΅, λ¨λΈμ„ νμΈνλ‹ν–λ‹¤λ©΄ μ–΄λ–»κ² μ„λΉ™ν•΄μ•Όν• μ§€ κ²°μ •ν•΄μ•Όν•λ‹¤.
    - λ¨λ‹ν„°λ§, μ μ§€λ³΄μ, λ¨λΈ μ—…λ°μ΄νΈμ— λ€ν• μ •μ±…κ³Ό μμ‚°μ„ μλ¦½ν•΄μ•Όν•λ‹¤.<br/><mark>λ² μ΄μ¤ λ¨λΈμ€ λ‹Ήμ‹ μ΄ νμΈνλ‹ν• λ¨λΈμ„ κ°μ„ ν•λ” μ†λ„λ³΄λ‹¤ λΉ λ¥΄κ² κ°μ„ λ  μ μλ‹¤.</mark>
- λ§μ€ κ²½μ°μ— λ‚μ€ λ¨λΈλ΅ κµμ²΄ν•λ” κ²ƒμ€ μ„±λ¥ ν–¥μƒμ— μμ–΄ λ§¤μ° μ‘μ€ λ¶€λ¶„λ§ μ κ³µν•λ‹¤.
- <mark>AI μ—”μ§€λ‹μ–΄λ§ μ‹¤ν—μ€ ν”„λ΅¬ν”„ν…μΌλ΅ μ‹μ‘λμ–΄μ•Ό ν•λ‹¤.</mark>
    - λ¨λΈμ μ„±λ¥μ€ μ„λ΅ λ‹¤λ¥Έ ν”„λ΅¬ν”„νΈμ— λ”°λΌ λ§¤μ° ν¬κ² λ‹¤λ¥Ό μ μλ‹¤.
- ν”„λ΅¬ν”„νΈκ°€ λΉ„ν¨μ¨μ μ΄λΌκ³  μ£Όμ¥ν•κ³  νμΈνλ‹μ μ •λ‹Ήμ„±μ„ μ£Όμ¥ν• λ§μ€ κ²½μ°, ν”„λ΅¬ν”„νΈ μ‹¤ν—μ΄ μµμ†ν™”λκ³  μ²΄κ³„μ μ΄μ§€ μ•μ•λ‹¤. μ§€μ‹κ°€ λ¶λ…ν™•ν•κ³ , μμ κ°€ μ‹¤μ  λ°μ΄ν„°λ¥Ό λ€ν‘ν•μ§€ μ•κ³ , μ§€ν‘κ°€ μ–΄μ„¤ν”„κ² μ •μλμ—λ‹¤. <mark>ν”„λ΅¬ν”„νΈ μ‹¤ν— κ³Όμ •μ„ μ •κµν™”ν•κ³ λ‚μ„λ” ν”„λ΅¬ν”„νΈ ν’μ§μ΄ ν•΄λ‹Ή μ‚¬λ΅€μ μ• ν”λ¦¬μΌ€μ΄μ…μ— μ¶©λ¶„ν•  μ •λ„λ΅ ν–¥μƒλμ—λ‹¤.</mark>
- νμΈνλ‹μ„ μ£Όμ¥ν•λ” μ—”μ§€λ‹μ–΄ μ¤‘ λ‡μ€ λ‹¨μ§€ νμΈνλ‹μ„ λ°°μ°κ³  μ‹¶μ€ κ²½μ°κ°€ μλ‹¤.
    - λ¦¬λ”μ‹­ μ„μΉλΌλ©΄ νμΈνλ‹μ΄ μ •λ§ ν•„μ”ν• κ²ƒμΈμ§€ λ‹¨μ§€ ν•κ³  μ‹¶μ€κ²ƒμΈμ§€ κµ¬λ³„ν•κΈ° μ–΄λ µλ‹¤.

<aside mark="π’΅">
λ„λ©”μΈ νΉν™” μ‘μ—… νμΈνλ‹ν•κΈ°
<ul>
<li>λ²”μ© λ¨λΈμ λ¥λ ¥μ΄ ν–¥μƒλ  μλ΅ λ„λ©”μΈ νΉν™” μ‘μ—…μ— λ„λ©”μΈ νΉν™” λ¨λΈλ³΄λ‹¤ λ‚μ€ μ„±λ¥μ„ λ³΄μ΄κ³  μλ‹¤.</li>
<li>λ„λ©”μΈ νΉν™” λ¨λΈμΈ BloombergGPT(March 2023)λ¥Ό λ²”μ© λ¨λΈμΈ GPT-4-0314κ°€ ν›¨μ”¬ λ¥κ°€ν• κ²½μ°κ°€ μλ‹¤.</li>
</ul>

<div style="text-align: center;"><img src="{{ "/assets/img/posts/study/ai-engineering/chapter7-8/table7-1.png" | relative_url }}" width="540px"/></div>

</aside>
- νμΈνλ‹κ³Ό ν”„λ΅¬ν”„νΈ μ‹¤ν— λ¨λ‘ μ²΄κ³„μ  κ³Όμ •μ΄ ν•„μ”ν•λ‹¤. ν”„λ΅¬ν”„νΈ μ‹¤ν—μ„ μν–‰ν•λ” κ²ƒμ€ κ°λ°μκ°€ ν‰κ°€ νμ΄ν”„λΌμΈ, λ°μ΄ν„° μ£Όμ„ κ°€μ΄λ“λΌμΈ λ° μ‹¤ν— μ¶”μ  κ΄€ν–‰μ„ κµ¬μ¶•ν•  μ μκ² ν•λ©°, μ΄λ” νμΈνλ‹μ„ μ„ν• λ””λ”¤λμ΄ λ  κ²ƒμ΄λ‹¤.
- νμΈνλ‹μ ν•κ°€μ§€ μ΄μ μ€ ν† ν° μ‚¬μ©μ„ μ·¨μ ν™”ν•λ”λ° λ„μ›€μ΄ λλ‹¤λ” κ²ƒμ΄λ‹¤. μ΄λ” ν”„λ΅¬ν”„νΈ μΊμ‹±μ΄ μ†κ°λκΈ°μ „κΉμ§€ μ ν¨ν–λ‹¤.
    - <mark>λ§¤ ν”„λ΅¬ν”„νΈλ§λ‹¤ μμ λ¥Ό ν¬ν•¨ν•μ§€ μ•κ³ , ν•΄λ‹Ή μμ λ“¤λ΅ λ¨λΈμ„ νμΈνλ‹ν•  μ μλ‹¤.</mark> μ΄λ” νμΈνλ‹ν• λ¨λΈμ„ λ” μ§§μ€ ν”„λ΅¬ν”„νΈλ΅ μ‚¬μ©ν•  μ μκ² ν•λ‹¤.
- ν”„λ΅¬ν”„νΈ μΊμ‹±μ„ μ‚¬μ©ν•λ©΄, λ°λ³µμ μΈ ν”„λ΅¬ν”„νΈ κµ¬λ¬Έμ€ μ¬μ‚¬μ©μ„ μ„ν•΄ μΊμ‹λ  μ μμ–΄μ„ κ°•λ ¥ν• μ΄μ μ΄ λμ§€λ” λ»ν•λ‹¤.
- ν”„λ΅¬ν”„νΈμ— μ κ³µν•  μ μλ” μμ μ μλ” μµλ€ μ»¨ν…μ¤νΈ κΈΈμ΄μ— μ ν•λλ‹¤.
    - <mark>νμΈνλ‹μ„ μ΄μ©ν•λ©΄, μ‚¬μ©ν•  μ μλ” μμ μ μμ— μ ν•μ΄ μ—†λ‹¤.</mark>

<div style="text-align: center;"><img src="{{ "/assets/img/posts/study/ai-engineering/chapter7-8/figure7-2.png" | relative_url }}" width="540px"/></div>

#### νμΈνλ‹κ³Ό RAG
- ν”„λ΅¬ν”„νΈλ΅λ¶€ν„° κ°€λ¥ν• μ„±λ¥ ν–¥μƒμ„ μµλ€ν™”ν•κ³ λ‚μ„λ” RAGλ‚ νμΈνλ‹ μ¤‘ μ–΄λ–¤ κ±Έ μ‹λ„ν•  μ§€ κ³ λ―Όν•  μ μλ‹¤. <mark>μ΄λ” λ¨λΈμ μ‹¤ν¨κ°€ μ •λ³΄<small>information-based</small> λλ” ν–‰λ™<small>behavior-based</small>μ— κΈ°μΈν• κ²ƒμΈμ§€μ— λ”°λΌ λ‹¤λ¥΄λ‹¤.</mark>
- λ¨λΈμ΄ μ •λ³΄ λ¶€μ΅±μΌλ΅ μ‹¤ν¨ν•λ‹¤λ©΄ λ¨λΈμ΄ μ—°κ΄€ λ μ •λ³΄μ μ¶μ²μ— μ ‘κ·Όν•  μ μλ„λ΅ν•λ” RAG μ‹μ¤ν…μ΄ λ„μ›€μ„ μ¤„ μ μλ‹¤. μ •λ³΄μ— κΈ°μΈν• μ‹¤ν¨λ” μ¶λ ¥μ΄ μ‚¬μ‹¤μ μΌλ΅ ν‹€λ Έκ±°λ‚ κΈ°ν•μ΄ μ§€λ‚¬μ„ κ²½μ° λ°μƒν•λ‹¤. 
    - μ •λ³΄ λ¶€μ΅±
        - κ³µκ° λ¨λΈμ€ λ‹Ήμ‹  μ΅°μ§μ μ‚¬μ  μ •λ³΄λ¥Ό ν¬ν•¨ν•κ³  μμ§€ μ•λ‹¤.
    - κΈ°ν• μ§€λ‚ μ •λ³΄
        - Taylor Swiftμ μ•¨λ²”μλ¥Ό λ¬Όμ–΄λ³Ό κ²½μ° λ¨λΈμ cut-off λ‚ μ§μ— λ”°λΌ λ‹¤λ¥΄κ² μ‘λ‹µν•  μ μλ”°.
- [Fine-Tuning or Retrieval?](https://arxiv.org/pdf/2312.05934)μ— λ”°λ¥΄λ©΄ <mark>μµμ‹  μ •λ³΄κ°€ ν•„μ”ν• μ‘μ—…μ κ²½μ° νμΈνλ‹ λ¨λΈλ³΄λ‹¤ RAGκ°€ λ” λ‚μ€ μ„±λ¥μ„ λ³΄μ€λ‹¤.</mark> λν•, λ² μ΄μ¤ λ¨λΈμ„ ν†µν• RAGκ°€ νμΈνλ‹ λ¨λΈμ„ ν†µν• RAGλ³΄λ‹¤ λ‚μ€ μ„±λ¥μ„ λ³΄μ€λ‹¤. μ΄λ” νμΈνλ‹μ€ νΉμ • μ‘μ—…μ— λ¨λΈμ μ„±λ¥μ„ ν–¥μƒμ‹ν‚¬ μ μμ§€λ§, λ‹¤λ¥Έ λ¶„μ•Όμ— λ€ν• μ„±λ¥μ„ μ•½ν™”μ‹ν‚¬ μ μλ‹¤λ” κ²ƒμ„ μ‹μ‚¬ν•λ‹¤.
- <mark>λ¨λΈμ΄ ν–‰λ™ λ¬Έμ κ°€ μλ‹¤λ©΄ νμΈνλ‹μ΄ λ„μ›€μ΄ λ  μ μλ‹¤.</mark>
    - ν–‰λ™ λ¬Έμ  μμ‹λ” λ¨λΈμ μ¶λ ¥μ΄ μ‚¬μ‹¤μ μΌλ΅ λ§μ§€λ§ μ‘μ—…μ— λ¶€μ μ ν• κ²½μ°λ‹¤.
- λ‹¤λ¥Έ λ¬Έμ λ” μμƒν• μ¶λ ¥ ν•μ‹μ„ λ¨λΈμ΄ λ”°λ¥΄μ§€ λ»ν•λ” κ²½μ°λ‹¤.
    - μλ―Έμ  νμ‹±<small>semantic parsing</small>μ€ μμ—°μ–΄λ¥Ό JSONκ°™μ€ κµ¬μ΅°ν™” ν•μ‹μΌλ΅ λ³€ν™ν•λ” κ±Έ μλ―Έν•λ‹¤.
- μ”μ•½ν•μλ©΄ <mark>νμΈνλ‹μ€ ν•μ‹μ„ μ„ν•΄, RAGλ” μ‚¬μ‹¤μ„ μ„ν•΄ μ‹¤μ‹ν•λ‹¤.</mark>
    - RAG μ‹μ¤ν…μ€ λ¨λΈμ— μ™Έλ¶€ μ§€μ‹μ„ μ κ³µν•΄ λ” μ •ν™•ν•κ³  μ •λ³΄κ°€ ν’λ¶€ν• λ‹µλ³€μ„ μƒμ„±ν•  μ μκ² ν•λ‹¤.
    - RAG μ‹μ¤ν…μ€ λ¨λΈμ ν• λ£¨μ‹λ„¤μ΄μ… μ κ±°μ— λ„μ›€μ„ μ¤„ μ μλ‹¤.
    - νμΈνλ‹μ€ λ¨λΈμ΄ λ¬Έλ²•κ³Ό ν•μ‹μ„ μ΄ν•΄ν•κ³  λ”°λ¥Ό μ μλ„λ΅ ν•λ” λ° λ„μ›€μ„ μ¤€λ‹¤.
    - νμΈνλ‹λ„ ν• λ£¨μ‹λ„¤μ΄μ…μ„ μ¤„μΌ μ μλ‹¤. μ΄λ” λ°μ΄ν„° ν’μ§μ΄ μΆ‹μ„ λ•λ§μ΄κ³ , μ €ν’μ§ λ°μ΄ν„°λ” ν• λ£¨μ‹λ„¤μ΄μ…μ„ μ•…ν™”μ‹ν‚¬ μ μλ‹¤.
- <mark>λ¨λΈμ΄ μ •λ³΄κ³Ό ν–‰λ™ λ¬Έμ λ¥Ό λ¨λ‘ κ°€μ§€κ³  μλ‹¤λ©΄ RAGμΌλ΅ μ‹μ‘ν•λΌ.</mark>
- <mark>RAGμ„ μ§„ν–‰ν•  λ•, BM25 μ©μ–΄ κΈ°λ° λ°©λ²•μ„ λ¨Όμ € μ‹λ„ν•λ‹¤.</mark> λ²΅ν„° λ°μ΄ν„°λ² μ΄μ¤λ¥Ό ν•„μ”λ΅ν•λ” λ°©λ²•μ€ λ‚μ¤‘μ΄λ‹¤.
- <mark>RAGμ€ νμΈνλ‹λ³΄λ‹¤ λ” ν° μ„±λ¥ ν–¥μƒμ„ κ°€μ Έμ¬ μ μλ‹¤.</mark>
- RAGμ™€ νμΈνλ‹μ€ μƒνΈ λ°°νƒ€μ μ΄μ§€ μ•κ³ , μ• ν”λ¦¬μΌ€μ΄μ… μ„±λ¥μ μµλ€ν™”λ¥Ό μ„ν•΄ ν•¨κ» μ‚¬μ©λκΈ°λ„ ν•λ‹¤.
    - [Ovadia et al. (2024)](https://arxiv.org/pdf/2312.05934)λ” νμΈνλ‹ λ¨λΈ μ„μ— RAGλ¥Ό μ‚¬μ©ν•λ” κ²ƒμ€ MMLUE λ²¤μΉλ§ν¬μ—μ„ μ„±λ¥ ν–¥μƒμ„ λ³΄μΈ κ²½μ°λ¥Ό ν¬ν•¨ν•λ‹¤.
    - 57%μ κ²½μ° RAGλ§ μ‚¬μ©ν• κ²½μ°μ— λΉ„ν•΄ νμΈνλ‹κ³Ό RAGλ¥Ό ν•¨κ» μ‚¬μ©ν• κ²½μ°λ³΄λ‹¤ μ„±λ¥ ν–¥μƒμ„ λ³΄μ΄μ§€ λ»ν–λ‹¤.

<div style="text-align: center;"><img src="{{ "/assets/img/posts/study/ai-engineering/chapter7-8/figure7-3.png" | relative_url }}" width="540px"/></div>

- λ¨λΈμ μ μ‘ κ³Όμ •μ€ μ•„λμ²λΌ μ”μ•½ν•  μ μλ‹¤.
    1. ν”„λ΅¬ν”„νΈλ§μΌλ΅ μ‘μ—…μ„ μν–‰ν•  μ μλ” λ¨λΈμ„ κµ¬ν•λ ¤κ³  μ‹λ„ν•λ‹¤. ν”„λ΅¬ν”„ν… μ‹ μ²΄κ³„μ μΈ λ²„μ „ κ΄€λ¦¬λ¥Ό μν–‰ν•λ‹¤.
    2. ν”„λ΅¬ν”„νΈμ— μμ λ¥Ό λ” μ¶”κ°€ν•λ‹¤. μμ λ” λ€κ° 1μ—μ„ 50κ° μ •λ„λ‹¤.
    3. μ •λ³΄ λ¶€μ΅±μΌλ΅ μμ£Ό μ‹¤ν¨ν•λ©΄ RAGλ¥Ό λ„μ…ν•κ³ , μ©μ–΄ κΈ°λ° κ²€μƒ‰λ¶€ν„° μ‹λ„ν•λ‹¤. κ°„λ‹¨ν• μ΅°ν<small>retrieval</small>λ§μΌλ΅λ„ μ μ ν•κ³  μ •ν™•ν• μ§€μ‹ μ κ³µμΌλ΅ λ¨λΈμ μ„±λ¥ ν–¥μƒμ„ μ΄λ μ μλ‹¤.
    4. λ¨λΈμ μ‹¤ν¨ λ°©λ²•μ— λ”°λΌ μ•„λλ¥Ό μ‹λ„ν•λ‹¤.
        1. μ •λ³΄ λ¶€μ΅±μΌλ΅ μΈν• μ‹¤ν¨ μ‹ μ„λ² λ”© κΈ°λ° κ²€μƒ‰κ³Ό κ°™μ€ κ³ κΈ‰ RAG λ°©λ²•μ„ RAGμ— λ„μ…ν•λ‹¤.
        2. ν–‰λ™ λ¬Έμ (λ¶€μ μ ν•κ±°λ‚ ν•μ‹μ΄ ν‹€λ¦¬κ±°λ‚, λ¶μ•μ „ν• λ‹µλ³€)κ°€ μλ‹¤λ©΄ νμΈνλ‹μ„ μ„ νƒν•  μ μλ‹¤. 
            - μ„λ² λ”© κΈ°λ° κ²€μƒ‰μ€ μ¶”λ΅ μ λ³µμ΅λ„λ¥Ό λ†’νλ” λ°λ©΄, νμΈνλ‹μ€ λ¨λΈμ κ°λ°μ λ³µμ΅λ„λ¥Ό λ†’νκ³  μ¶”λ΅ μ€ μ μ§€ν•λ‹¤.
    5. RAGμ™€ νμΈνλ‹μ„ κ²°ν•©ν•΄ μ„±λ¥μ„ λ” ν–¥μƒμ‹ν‚¨λ‹¤.

### λ©”λ¨λ¦¬ λ³‘λ©
νμΈνλ‹μ€ λ©”λ¨λ¦¬ μ§‘μ•½μ μ΄μ–΄μ„ λ§μ€ νμΈνλ‹ κΈ°μ λ“¤μ΄ λ©”λ¨λ¦¬ λ°μκµ­μ„ μµμ†ν™”ν•λ” κ²ƒμ„ λ©ν‘λ΅ ν•κ³  μλ‹¤.

<aside mark="π’΅">
λ©”λ¨λ¦¬ λ³‘λ©μ„ μ΄ν•΄ν•κΈ° μ„ν• ν•µμ‹¬ μ”μ†
<ol>
<li>νμ΄λ°μ΄μ… λ¨λΈμ κ·λ¨λ΅ μΈν•΄ λ©”λ¨λ¦¬λ” μ¶”λ΅ κ³Ό νμΈνλ‹ λ¨λ‘μ— λ³‘λ©μ΄λ‹¤. νμΈνλ‹μ„ μ„ν• λ©”λ¨λ¦¬ μ”κµ¬λ” ν•™μµ λ°©λ²•μ— μν•΄ μ¶”λ΅ λ³΄λ‹¤ ν›¨μ‹  ν¬λ‹¤.</li>
<li>λ¨λΈμ <mark>λ©”λ¨λ¦¬ λ°μκµ­μ— ν¬κ² κΈ°μ—¬ν•λ” κ²ƒμ€ νλΌλ―Έν„° μ, ν•™μµ νλΌλ―Έν„°<small>trainable parameter</small> μ λ° μ«μ ν‘ν„<small>numerical representations</small>μ΄λ‹¤.</mark></li>
<li>ν•™μµ νλΌλ―Έν„° μκ°€ λ§μ„ μλ΅ λ©”λ¨λ¦¬ λ°μκµ­λ„ ν¬λ‹¤. <mark>ν•™μµ νλΌλ―Έν„° μλ¥Ό μ¤„μ΄λ ¤λ” κ²ƒμ΄ PEFT<small>parameter-efficient finetunig</small>μ λ™κΈ°λ‹¤.</mark></li>
<li><mark>μ–‘μν™”<small>Quantization</small>λ” λ¨λΈμ„ λ” μ μ€ λΉ„νΈμ ν•μ‹μΌλ΅ λ°”κΎΈλ” κ΄€ν–‰μ„ μλ―Έν•λ‹¤.</mark> μ–‘μν™”λ” λ¨λΈμ λ©”λ¨λ¦¬ λ°μκµ­μ„ μ¤„μ΄λ”λ° κ°„λ‹¨ν•κ³  ν¨μ¨μ μΈ λ°©λ²•μ΄λ‹¤.</li>
<li>μ¶”λ΅ μ€ λ€κ° κ°€λ¥ν•ν• μ μ€ λΉ„νΈ μλ΅ μν–‰λλ‹¤.(16, 8, 4 bits)</li>
<li>ν›λ ¨μ΄ μ ν‘ν„μ— λ” λ―Όκ°ν•΄ μ μ€ μ •λ°€λ„λ΅ λ¨λΈμ„ ν›λ ¨ν•λ” κ²ƒμ΄ λ” μ–΄λ µλ‹¤. ν›λ ¨μ€ λ€κ° νΌν•© μ •λ°€λ„λ΅ μν–‰λλ‹¤(32-bitμ™€ 16-bit λλ” 8-bit νΌν•©).</li>
</ol>
</aside>

#### μ—­μ „νμ™€ ν•™μµ νλΌλ―Έν„°
- νμΈ νλ‹μ λ©”λ¨λ¦¬ μ‚¬μ©λ‰μ—μ„ ν•µμ‹¬ μ”μ†λ” ν•™μµ νλΌλ―Έν„°<small>trainable parameters</small>μ μλ‹¤. ν•™μµ νλΌλ―Έν„°λ” νμΈνλ‹ μ¤‘ μ—…λ°μ΄νΈλλ” νλΌλ―Έν„°λ¥Ό μλ―Έν•λ‹¤.
λ³€ν•μ§€ μ•λ” νλΌλ―Έν„°λ” κ³ μ • νλΌλ―Έν„°<small>frozen parameters</small>λΌκ³  ν•λ‹¤.
- ν„μ¬ μ‹ κ²½λ§μ€ λ€κ° μ—­μ „ν<small>backpropagation</small> λ©”μ»¤λ‹μ¦μΌλ΅ ν›λ ¨λλ‹¤.
    - μ—­μ „νλ” ν›λ ¨μ„ 2κ°€μ§€ λ‹¨κ³„λ΅ κµ¬λ¶„ν•λ‹¤.
        1. μλ°©ν–¥ μ „λ‹¬<small>forward pass</small>: μ…λ ¥μΌλ΅λ¶€ν„° μ¶λ ¥μ„ κ³„μ‚°ν•λ” κ³Όμ •
        2. μ—­λ°©ν–¥ μ „λ‹¬<small>backward pass</small>: μλ°©ν–¥ μ „λ‹¬λ΅λ¶€ν„° μ§‘κ³„λ μ‹ νΈλ¥Ό μ΄μ©ν•΄ λ¨λΈμ κ°€μ¤‘μΉλ¥Ό μμ •ν•λ” κ³Όμ •
- μ¶”λ΅ μ€ μλ°©ν–¥ μ „λ‹¬λ§ μν–‰ν•λ‹¤. ν›λ ¨μ€ λ‘ κ³Όμ • λ¨λ‘ μν–‰ν•λ‹¤.
- κ±°μ‹μ  κ΄€μ μ—μ„ μ—­μ „νλ” μ•„λμ™€ κ°™μ€ μ‘μ—…μ„ μν–‰ν•λ‹¤.
    1. μ •κ³Όμ •μ—μ„ κ³„μ‚°λ μ¶λ ¥κ³Ό κΈ°λ€ μ¶λ ¥(μ‹¤μ  μ°Έκ°’)μ„ λΉ„κµν•λ‹¤. λ‘  μ¶λ ¥μ μ°¨μ΄λ” μ†μ‹¤<small>loss</small>λΌ ν•λ‹¤.
    2. κ° ν•™μµ νλΌλ―Έν„°κ°€ μ–Όλ§λ‚ μ‹¤μμ— κΈ°μ—¬ν–λ”μ§€ κ³„μ‚°ν•λ‹¤. κΈ°μ—¬λ„λ” κ·ΈλΌλ””μ–ΈνΈ<small>gradient</small>μ΄λΌκ³  ν•λ‹¤. μν•™μ μΌλ΅ κ·ΈλΌλ””μ–ΈνΈλ” μ†μ‹¤μ„ κ° ν•™μµ νλΌλ―Έν„°μ— λ”°λΌ νΈλ―Έλ¶„ν• κ°’μΌλ΅ κ³„μ‚°λλ‹¤.
    3. ν•™μµ νλΌλ―Έν„°λ¥Ό κ° κ·ΈλΌλ””μ–ΈνΈμ— λ”°λΌ μ΅°μ •ν•λ‹¤. <mark>κ° κ·ΈλΌλ””μ–ΈνΈ κ°’μ— λ”°λΌ κ° νλΌλ―Έν„°κ°€ μ–Όλ§λ‚ μ¬μ΅°μ •λλ”μ§€λ” μµν‹°λ§μ΄μ €<small>optimizer</small>μ— μν•΄ κ²°μ •λλ‹¤.</mark> ν”ν• μµν‹°λ§μ΄μ €λ” SGD<small>stochastic gradient descent</small>μ™€ Adamμ΄λ‹¤. νΈλμ¤ν¬λ¨Έ κΈ°λ° λ¨λΈμ€ Adamμ΄ ν„μ¬ κ°€μ¥ λ§μ΄ μ“°μ΄λ” μµν‹°λ§μ΄μ €λ‹¤.
- μ—­μ „ν μ™Έμ μ λ§ν• ν›λ ¨ μ ‘κ·Όλ²•μ€ [Maheswaranathan el al.](https://proceedings.mlr.press/v97/maheswaranathan19a.html)μ΄ μ μ•ν• κ·Όμ‚¬ κ·ΈλΌλ””μ–ΈνΈμ™€ λλ¤ νƒμƒ‰μ„ κ²°ν•©ν• μ§„ν™”μ  μ „λµ<small>evolutionary strategy</small>μ΄λ‹¤.

<div style="text-align: center;"><img src="{{ "/assets/img/posts/study/ai-engineering/chapter7-8/figure7-4.png" | relative_url }}" width="540px"/></div>

- <mark>μ—­λ°©ν–¥ μ „λ‹¬ μ‹ ν•™μµ νλΌλ―Έν„°λ” κ·ΈλΌλ””μ–ΈνΈμ™€ μµν‹°λ§μ΄μ € μƒνƒλΌλ” μ¶”κ°€μ μΈ κ°’κ³Ό ν•¨κ» μ΅΄μ¬ν•κ² λλ‹¤.</mark>

#### λ©”λ¨λ¦¬ κ³„μ‚°
λ¨λΈμ— ν•„μ”ν• λ©”λ¨λ¦¬λ‰μ„ μ•λ©΄ μ ν•©ν• ν•λ“μ›¨μ–΄λ¥Ό μ„ νƒν•  λ• μ μ©ν•λ‹¤.

##### μ¶”λ΅ μ— ν•„μ”ν• λ©”λ¨λ¦¬
- μ¶”λ΅ μ—λ” μλ°©ν–¥ μ „λ‹¬λ§ μν–‰λλ‹¤.
- λ¨λΈμ νλΌλ―Έν„° μλ¥Ό $$ N $$, κ° νλΌλ―Έν„°μ— ν•„μ”ν• λ©”λ¨λ¦¬λ‰μ„ $$ M $$μ΄λΌν•λ©΄ λ¨λΈμ νλΌλ―Έν„°λ¥Ό λ¶λ¬μ¤λ” λ° ν•„μ”ν• λ©”λ¨λ¦¬λ‰μ€ μ•„λμ™€ κ°™λ‹¤.

$$ N \times M $$

- μλ°©ν–¥ μ „λ‹¬ μ‹ ν™μ„±ν™” κ°’<small>activation values</small>λ¥Ό μ„ν• λ©”λ¨λ¦¬λ„ ν•„μ”ν•λ‹¤. νΈλμ¤ν¬λ¨Έ λ¨λΈμ€ μ–΄ν…μ… λ©”μ»¤λ‹μ¦μ„ μ„ν• ν‚¤-λ²¨λ¥ λ²΅ν„°λ¥Ό λ‹΄μ„ λ©”λ¨λ¦¬κ°€ ν•„μ”ν•λ‹¤. μ΄λ” μ‹ν€€μ¤ κΈΈμ΄μ™€ λ°°μΉ μ‚¬μ΄μ¦μ— λ”°λΌ μ„ ν•μ μΌλ΅ μ¦κ°€ν•λ‹¤.
- λ§μ€ μ•±μ—μ„ ν™μ„±ν™”μ™€ ν‚¤-λ²¨λ¥ λ²΅ν„°λ¥Ό μ„ν• λ©”λ¨λ¦¬λ” λ¨λΈμ <mark>κ°€μ¤‘μΉ λ©”λ¨λ¦¬μ 20%</mark>λ΅ κ°€μ •ν•  μ μλ‹¤.
    - μ»¨ν…μ¤νΈ κΈΈμ΄λ‚ λ°°μΉ ν¬κΈ°κ°€ λ” ν¬λ‹¤λ©΄ μ‹¤μ  λ©”λ¨λ¦¬ μ‚¬μ©λ‰μ€ λ” λ†’μ„ μ μλ‹¤.
    - κ°€μ •μ— λ”°λ¥Έ λ©”λ¨λ¦¬ μ‚¬μ©λ‰μ€ μ•„λμ™€ κ°™λ‹¤.

$$ N \times M \times 1.2 $$

- 13B νλΌλ―Έν„° λ¨λΈ, νλΌλ―Έν„° λ‹Ή 2 λ°”μ΄νΈλΌκ³  κ°€μ •ν•λ©΄ 13B * 2 bytes = 26GBμ κ°€μ¤‘μΉ λ©”λ¨λ¦¬κ°€ ν•„μ”ν•λ‹¤. μ¶”λ΅ μ— ν•„μ”ν• μ΄ λ©”λ¨λ¦¬μ–‘μ€ 26GB * 1.2 = 31.2GBλ‹¤.


##### ν›λ ¨μ— ν•„μ”ν• λ©”λ¨λ¦¬
- <mark>λ¨λΈμ„ ν›λ ¨ν•λ ¤λ©΄ λ¨λΈμ κ°€μ¤‘μΉμ™€ ν™μ„±ν™” κ°’, κ·ΈλΌλ””μ–ΈνΈμ™€ μµν‹°λ§μ΄μ € μƒνƒλ¥Ό μ„ν• λ©”λ¨λ¦¬κ°€ ν•„μ”ν•λ‹¤.</mark>

$$ \text{Training memory} = \text{model weights + activations} + \text{gradients} + \text{optimizer states} $$ 

<aside mark="π¦">
μ—­λ°©ν–¥ μ „λ‹¬ μ‹ κ° ν•™μµ νλΌλ―Έν„°λ” κ·ΈλΌλ””μ–ΈνΈ κ°’κ³Ό μµλ€ 2κ°μ μµν‹°λ§μ΄μ € μƒνƒ κ°’μ„ ν•„μ”λ΅ ν•λ‹¤.
<ul>
<li>λ°”λ‹λΌ SGD μµν‹°λ§μ΄μ €λ” μƒνƒκ°€ μ—†λ‹¤: 0</li>
<li>λ¨λ©ν…€ μµν‹°λ§μ΄μ €λ” ν•™μµ νλΌλ―Έν„° λ‹Ή 1κ°μ κ°’μ„ μ €μ¥ν•λ‹¤: 1</li>
<li>Adam μµν‹°λ§μ΄μ €λ” ν•™μµ νλΌλ―Έν„° λ‹Ή 2κ°μ κ°’μ„ μ €μ¥ν•λ‹¤: 2</li>
</ul>
</aside>

- 13B νλΌλ―Έν„° λ¨λΈμ„ μƒκ°ν•΄λ³΄μ. Adam μµν‹°λ§μ΄μ € μ‚¬μ© μ‹ κ° ν•™μµ νλΌλ―Έν„°λ” κ·ΈλΌλ””μ–ΈνΈμ™€ μµν‹°λ§μ΄μ € μƒνƒλ¥Ό μ„ν• μ„Έ κ°μ κ°’μ΄ ν•„μ”ν•λ‹¤. κ° κ°’μ„ μ €μ¥ν•λ”λ° 2 λ°”μ΄νΈκ°€ ν•„μ”ν•λ‹¤λ©΄ ν•„μ”ν• λ©”λ¨λ¦¬λ‰μ€ μ•„λμ™€ κ°™λ‹¤.

$$ 13 \text{billion} \times 3 \times 2 \text{bytes} = 78 \text{GB} $$

- μ„ κ³„μ‚°μ—μ„  ν™μ„±ν™”μ— ν•„μ”ν• λ©”λ¨λ¦¬λ‰μ΄ λ¨λΈμ κ°€μ¤‘μΉμ— ν•„μ”ν• λ©”λ¨λ¦¬λ³΄λ‹¤ λ§¤μ° μ λ‹¤κ³  κ°€μ •ν–λ”°. ν„μ‹¤μ—μ„  ν™μ„±ν™” λ©”λ¨λ¦¬κ°€ ν›¨μ”¬ ν΄ μ μλ‹¤.
- <mark>ν™μ„±ν™”μ— ν•„μ”ν• λ©”λ¨λ¦¬λ‰μ„ μ¤„μ΄κΈ° μ„ν• ν• λ°©λ²•μ€ ν™μ„±ν™” κ°’μ„ μ €μ¥ν•μ§€ μ•λ” κ²ƒμ΄λ‹¤. μ΄λ” κ·ΈλΌλ””μ–ΈνΈ μ²΄ν¬ν¬μΈν…<small>gradient checkpointing</small> λλ” ν™μ„±ν™” μ¬κ³„μ‚°<small>activation recomputation</small>μ΄λΌκ³  λ¶λ¦°λ‹¤.</mark> μ΄κ²ƒμ΄ λ©”λ¨λ¦¬ μ”κµ¬λ‰μ„ μ¤„μΌ μ μμ§€λ§ μ¬κ³„μ‚°μΌλ΅ μΈν•΄ ν›λ ¨μ— ν•„μ”ν• μ‹κ°„μ΄ μ¦κ°€ν•  μ μλ‹¤.

<div style="text-align: center;"><img src="{{ "/assets/img/posts/study/ai-engineering/chapter7-8/figure7-5.png" | relative_url }}" width="540px"/></div>

#### μ ν‘ν„<small>Numerical Presentations</small>
- μ‹ κ²½λ§μ μ«μ κ°’μ€ μ „ν†µμ μΌλ΅ λ¶€λ™μ†μμ  μ«μ<small>float numbers</small>λ΅ ν‘ν„λλ‹¤.
- κ°€μ¥ μΌλ°μ μΈ λ¶€λ™μ†μμ  ν•μ‹μ€ FP κ³„μ—΄λ΅, μ΄λ” μ „κΈ°μ „μκΈ°μ μν‘ν(IEEE) λ¶€λ™μ†μμ  μ—°μ‚° ν‘μ¤€([IEEE 754](https://en.wikipedia.org/wiki/IEEE_754))λ¥Ό μ¤€μν•λ‹¤.

Format | Size | Precision Level
-- | -- | --
FP32 | 32bits(4bytes) | Single precision
FP64 | 64bits(8bytes) | Double precision
FP16 | 16bits(2bytes) | Half precision

- FP64λ” NumPyμ™€ pandasκ°™μ€ λΌμ΄λΈλ¬λ¦¬μ κΈ°λ³Έ ν•μ‹μ΄λ‹¤.
- μ‹ κ²½λ§μ—μ„λ” FP64μ λ§μ€ λ©”λ¨λ¦¬ μ”κµ¬λ‰μΌλ΅ μΈν•΄ FP32, FP16κ°€ λ” μΌλ°μ μ΄λ‹¤.
- AI μ‘μ—… λ¶€ν•μ—μ„ λ‹¤λ¥Έ μΈκΈ°μλ” λ¶€λ™μ†μμ  ν•μ‹μ€ *BF16*(BFloat16)κ³Ό *TF32*(TensorFloat-32)λ‹¤. BF16μ€ TPUμ—μ„ AI μ„±λ¥μ„ μµμ ν™”ν•κΈ° μ„ν•΄ κµ¬κΈ€μ΄ μ„¤κ³„ν–κ³ , TF32λ” GPUλ¥Ό μ„ν•΄ NVIDIAκ°€ μ„¤κ³„ν–λ‹¤.
- μ ν‘ν„μ€ μ •μλ¥Ό ν‘ν„ν•  μλ„ μλ‹¤. μΌλ°μ μΈ μ •μ ν•μ‹μ€ INT8(8λΉ„νΈ μ •μ), INT4κ°€ μλ‹¤.
- κ° λ¶€λ™μ†μμ  ν•μ‹μ€ 1λΉ„νΈλ¥Ό μ«μμ λ¶€νΈ(μ–‘μ)λ¥Ό μ €μ¥ν•λ”λ° μ‚¬μ©ν•λ‹¤. λ‚λ¨Έμ§€ λΉ„νΈλ“¤μ€ λ²”μ„<small>range</small>μ™€ μ •λ°€λ„<small>precision</small>λ΅ λ‚λ‰λ‹¤.
    - λ²”μ„<small>range</small>: ν•μ‹μ΄ ν‘ν„ν•  μ μλ” κ°’μ λ²”μ„λ¥Ό κ²°μ •
    - μ •λ°€λ„<small>precision</small>: μ«μκ°€ μ–Όλ§λ‚ μ •λ°€ν•κ² ν‘ν„λλ”μ§€ κ²°μ •. 10.12λ” 10.1234λ³΄λ‹¤ λ μ •λ°€ν•¨

<div style="text-align: center;"><img src="{{ "/assets/img/posts/study/ai-engineering/chapter7-8/figure7-6.png" | relative_url }}" width="540px"/></div>
<p></p>
<div style="text-align: center;"><img src="{{ "/assets/img/posts/study/ai-engineering/chapter7-8/table7-3.png" | relative_url }}" width="540px"/></div>
<p></p>
<aside mark="π¦‘">
λ¨λΈμ„ λ¶λ¬μ¬ λ•λ” μλ„λ ν•μ‹μΌλ΅ λ¶λ¬μ¤λ„λ΅ ν™•μ‹¤ν•κ² ν•΄μ•Όν•λ‹¤.<br/>
λ¨λΈμ„ μλ»λ μ ν•μ‹μΌλ΅ λ¶λ¬μ¤λ©΄ λ¨λΈμ„ ν¬κ² λ‹¤λ¥΄κ² λ§λ“¤ μ μλ‹¤.<br/>
Llama2λ” BF16μΌλ΅ κ°€μ¤‘μΉλ¥Ό μ„¤μ •ν–λ”λ°, λ§μ€ ν€μ΄ FP16μΌλ΅ λ¨λΈμ„ λ¶λ¬μ™€ λ¨λΈμ ν’μ§μ΄ κ΄‘κ³ λ κ²ƒμ— λΉ„ν•΄ λ„λ¬΄ λ‚λΉ μ„ λ€ν•΄ λ‹ΉνΉν•΄ν–λ‹¤.
</aside>

#### μ–‘μν™”<small>Quantization</small>
- λ¨λΈμ κ°’μ„ ν‘ν„ν•λ”λ° μ μ€ λΉ„νΈκ°€ ν•„μ”ν• μλ΅ λ©”λ¨λ¦¬ λ°μκµ­λ„ λ‚®μ•„μ§„λ‹¤.
- <mark>μ •λ°€λ„λ¥Ό λ‚®μ¶”λ” μ–‘μν™”λ” λ¨λΈμ λ©”λ¨λ¦¬ λ°μκµ­μ„ μ €λ ΄ν•κ³  κ·Ήμ μΌλ΅ ν¨κ³Όμ μΌλ΅ μ¤„μ΄λ” λ°©λ²•μ΄λ‹¤.</mark>
- μ–‘μν™”λ¥Ό μν–‰ν•κΈ° μ„ν•΄μ„λ” λ¬΄μ—‡μ„, μ–Έμ ν•΄μ•Όν•λ”μ§€ κ²°μ •ν•΄μ•Όν•λ‹¤:
    - μ–‘μν™”ν•  κ²ƒ: λ¨λΈμ μ„±λ¥μ„ ν¬κ² ν•΄μΉμ§€ μ•λ” μ”μ†λ¥Ό μ–‘μν™”ν•  μ μλ‹¤. <mark>κ°€μ¤‘μΉ μ–‘μν™”λ” ν™μ„±ν™” μ–‘μν™”λ³΄λ‹¤ μΌλ°μ μ΄λ‹¤.</mark> κ°€μ¤‘μΉ μ–‘μν™”κ°€ λ” μ μ€ μ •ν™•λ„ κ°μ†λ¥Ό ν†µν•΄ μ„±λ¥μ— μ•μ •μ μΈ μν–¥μ„ λ―ΈμΉλ” κ²½ν–¥μ΄ μκΈ° λ•λ¬Έμ΄λ‹¤.
    - μ–Έμ  μ–‘μν™” ν•λ”κ°€: μ–‘μν™”λ” ν›λ ¨ μ¤‘ λλ” ν›λ ¨ ν›„ κ°€λ¥ν•λ‹¤. <mark>ν›λ ¨ ν›„ μ–‘μν™”<small>post-straining quantization</small>(PTQ)λ” λ¨λΈμ΄ μ™„μ „ν ν›λ ¨λ λ’¤ λ¨λΈμ„ μ–‘μν™”ν•λ” κ²ƒμ΄λ‹¤. ν„μ¬ PTQκ°€ κ°€μ¥ μΌλ°μ μ΄λ‹¤.</mark> λ¨λΈμ„ ν›λ ¨ν•μ§€ μ•λ” AI μ•± κ°λ°μμ—κ² μ ν•©ν•λ‹¤.

##### μ¶”λ΅  μ–‘μν™”
- λ”¥λ¬λ‹ μ΄κΈ°μ—” FP32μΌλ΅ λ¨λΈ ν›λ ¨ λ° μ„λΉ™μ„ ν–λ‹¤.
- 2010λ…„λ€ ν›„λ°μ΄ν›„ 16λΉ„νΈλ‚ λ” λ‚®μ€ μ •λ°€λ„λ΅ λ¨λΈμ„ μ„λΉ™ν•λ” κ² μΌλ°ν™”λλ‹¤.
   - [Dettmers et al. (2022)](https://arxiv.org/abs/2208.07339)λ” LLM.int8()λ΅ 8λΉ„νΈ, [Dettmers et al. (2023)](https://arxiv.org/abs/2305.14314)λ” QLoRAλ΅ 4λΉ„νΈμ μ–‘μν™”λ¥Ό ν›λ¥­ν•κ² κµ¬ν„ν–λ‹¤.
- λ¨λΈμ€ νΌν•© μ •λ°€λ„λ΅ μ„λΉ™λ  μ μλ‹¤.
    - [Apple (2024)](https://machinelearning.apple.com/research/introducing-apple-foundation-models)μ€ κΈ°κΈ°μ—μ„ μ§μ ‘ λ¨λΈμ„ μ„λΉ™ν•κΈ° μ„ν•΄ 2-bit, 4-bit νΌν•©μ ν‰κ·  3.5-bit-per-weightλ¥Ό μ‚¬μ©ν–λ‹¤.
    - NVIDIAλ” 4-bit λ¶€λ™μ†μμ  μ¶”λ΅ μ„ μ§€μ›ν•λ” [Blackwell (2024)](https://nvidianews.nvidia.com/news/nvidia-blackwell-platform-arrives-to-power-a-new-era-of-computing) GPU μ•„ν‚¤ν…μ²λ¥Ό λ°ν‘ν–λ‹¤.
- <mark>μΌλ°μ μΌλ΅ νλΌλ―Έν„° κ°’μ€ INT8, INT4 κ°™μ€ μ •μν•μΌλ΅ μ–‘μν™”λλ‹¤.</mark>
- [Ma et al. (2024)](https://arxiv.org/abs/2402.17764)μ€ BitNet b.158μ„ ν†µν•΄ 1λΉ„νΈ LLM μ‹λ€λ¥Ό μ§„μ…ν•¨μ„ μ„ μ–Έν–λ‹¤. μ΄λ” 3.9B νλΌλ―Έν„°κΉμ§€ 16-bit Llama2 μ„±λ¥κ³Ό κ²¬μ¤„λ§ν•λ‹¤.
- <mark>μ •λ°€λ„ κ°μ†λ” λ©”λ¨λ¦¬ λ°μκµ­μ„ μ¤„μ΄κ³  κ³„μ‚° μ†λ„λ΅ κ°μ„ ν•  μ μλ‹¤.</mark>
    - λ” ν° λ°°μΉ μ‚¬μ΄μ¦λ¥Ό κ°€λ¥ν•κ² ν•κ³ , λ¨λΈμ΄ λ” λ§μ€ μ…λ ¥μ„ λ³‘λ ¬λ΅ μ²λ¦¬ν•  μ μκ² ν•λ‹¤.
    - κ°μ†λ μ •λ°€λ„λ” κ³„μ‚°μ„ κ°€μ†ν•κ³  μ¶”λ΅  μ§€μ—°κ³Ό ν›λ ¨ μ‹κ°„μ„ μ¤„μΈλ‹¤.
- μ •λ°€λ„ κ°μμ λ‹¨μ μ€ κ° λ³€ν™μ΄ μΆ…μΆ… μ‘μ€ κ°’ λ³€ν™”λ¥Ό μ λ°ν•κ³  λ§μ€ μ‘μ€ λ³€ν™”κ°€ ν° μ„±λ¥ λ³€ν™”λ¥Ό μ•ΌκΈ°ν•  μ μλ‹¤λ” κ²ƒμ΄λ‹¤.
- PyTorch, TensorFlow, HuggingFaceμ νΈλμ¤ν¬λ¨Έλ¥Ό λΉ„λ΅―ν• μ£Όμ” ML ν”„λ μ„μ›ν¬λ” μ½”λ“ λ‡ μ¤„λ΅ κ°€λ¥ν• PTQμ„ λ¬΄λ£λ΅ μ κ³µν•λ‹¤.
- TensorFlow Liteλ‚ PyTorch Mobile κ°™μ€ κΈ°κΈ° λ‚΄ μ¶”λ΅ μ„ μ„ν• ν”„λ μ„μ›ν¬λ„ PTQλ¥Ό μ κ³µν•λ‹¤.

##### ν›λ ¨ μ–‘μν™”
- ν›λ ¨ μ¤‘ μ–‘μν™”λ” PTQλ³΄λ‹¤ μΌλ°μ μ΄μ§€ μ•μ§€λ§ μ μ°¨ μΈκΈ°λ¥Ό λκ³  μλ‹¤.
- ν›λ ¨ μ–‘μν™”μ 2κ°€μ§€ μ„λ΅λ‹¤λ¥Έ λ©ν‘:
    1. μ¶”λ΅  λ™μ• λ‚®μ€ μ •λ°€λ„λ΅ μΆ‹μ€ μ„±λ¥μ„ λ‚΄λ” λ¨λΈμ„ μƒμ‚°ν•λ‹¤.
    2. ν›λ ¨ μ‹κ°„κ³Ό λΉ„μ©μ„ μ¤„μΈλ‹¤.
- <mark>μ–‘μν™” μΈμ§€ ν›λ ¨<small>Quantization-aware training</small>(QAT)μ€ μ¶”λ΅ μ—μ„ λ‚®μ€ μ •λ°€λ„λ΅ λ†’μ€ ν’μ§μ„ λ³΄μ΄λ” λ¨λΈμ„ λ§λ“λ” κ²ƒμ„ λ©ν‘λ΅ ν•λ‹¤.</mark>
    - QATλ” ν›λ ¨ λ™μ• λ¨λΈμ΄ λ‚®μ€ μ •λ°€λ„ λ™μ‘μ„ μ‹λ®¬λ μ΄μ…ν•μ—¬ λ‚®μ€ μ •λ°€λ„μ—μ„ κ³ ν’μ§ μ¶λ ¥μ„ μƒμ‚°ν•λ” λ°©λ²•μ„ λ°°μΈ μ μκ² ν•λ‹¤.
    - QATλ” κ³„μ‚°μ΄ μ—¬μ „ν κ³ μ •λ°€λ„μ—μ„ μν–‰λκΈ° λ•λ¬Έμ— λ¨λΈμ ν›λ ¨ μ‹κ°„μ„ κ°μ†μ‹ν‚¤μ§€ μ•λ”λ‹¤.
    - <mark>QATλ” μ €μ •λ°€λ„ ν–‰λ™μ„ μ‹λ®¬λ μ΄μ…ν•λλΌ λ” λ§μ€ μ‘μ—…μ„ μν–‰ν•΄ ν›λ ¨ μ‹κ°„μ„ μ¦κ°€μ‹ν‚¬ μ μλ‹¤.</mark>
- <mark>μ €μ •λ°€λ„λ΅ λ¨λΈμ„ μ§μ ‘ ν›λ ¨μ‹ν‚¤λ©΄ λ‘ λ©ν‘λ¥Ό μ΄λ£¨λ”λ° λ„μ›€μ΄ λ  μ μλ‹¤.</mark>
    - [Character.AI (2024)](https://research.character.ai/optimizing-inference/)λ” λ¨λΈ μ „μ²΄λ¥Ό INT8λ΅ ν›λ ¨ν•΄ ν›λ ¨, μ„λΉ™κ°„ μ •λ°€λ„ λ¶€μ΅°ν™”λ¥Ό μ¤„μ΄κ³  ν›λ ¨ ν¨μ¨μ„±μ„ ν¬κ² λ†’ν”λ‹¤. ν•μ§€λ§ μ €μ •λ°€λ„ ν›λ ¨μ€ μ–΄λ ¤μ΄λ°, μ—­μ „νκ°€ μ €μ •λ°€λ„μ—μ„ λ” λ―Όκ°ν•κΈ° λ•λ¬Έμ΄λ‹¤.
- μ €μ •λ°€λ„ ν›λ ¨μ€ νΌν•© μ •λ°€λ„μ—μ„ μΆ…μΆ… μ΄λ£¨μ–΄μ§€λ”λ°, κ°€μ¤‘μΉλ” κ³ μ •λ°€λ„λ΅ μ μ§€ν•κ³  κ·ΈλΌλ””μ–ΈνΈλ‚ ν™μ„±ν™” κ°™μ€ λ‹¤λ¥Έ κ°’μ€ μ €μ •λ°€λ„λ΅ μ μ§€ν•λ” λ°©λ²•μ΄ μλ‹¤. λ λ―Όκ°ν• κ°€μ¤‘μΉ κ°’μ€ μ €μ •λ°€λ„λ΅ κ³„μ‚°ν•κ³  λ” λ―Όκ°ν• κ°€μ¤‘μΉλ” κ³ μ •λ°€λ„λ΅ κ³„μ‚°ν•  μλ„ μλ‹¤.
- λ§μ€ ML ν”„λ μ„μ›ν¬μ—μ„ μ κ³µλλ” [automatic mixed precision](https://developer.nvidia.com/automatic-mixed-precision) (AMT) κΈ°λ¥μ€ μ €μ •λ°€λ„κ°€ λ  μ μλ” λ¨λΈμ λ¶€λ¶„μ„ μλ™μΌλ΅ μ„¤μ •ν•λ‹¤.
- ν›λ ¨μ λ‹¤λ¥Έ λ‹¨κ³„μ—μ„λ” λ‹¤λ¥Έ μ •λ°€λ„ μμ¤€μ„ μ‚¬μ©ν•  μ μλ‹¤. λ¨λΈμ€ κ³ μ •λ°€λ„λ΅ ν›λ ¨λ ν›„ μ €μ •λ°€λ„λ΅ νμΈνλ‹λ  μ μλ‹¤.

### νμΈνλ‹ κΈ°μ 
<!-- p332 -->
- PEFTμ„ μ¤‘μ‹¬μΌλ΅ν• λ©”λ¨λ¦¬ ν¨μ¨μ μΈ νμΈνλ‹ κΈ°μ μ„ μ£Όλ΅ μ‚΄ν΄λ³Έλ‹¤.
- λ¨λΈμ„ μ‚¬μ©μν™”ν•κΈ° μ„ν•΄ μ‹¤ν—μ μΈ λ°©λ²•μΈ λ¨λΈ λ³‘ν•©λ„ μ•μ•„λ³Έλ‹¤.

#### νλΌλ―Έν„° ν¨μ¨μ μΈ νμΈνλ‹<small>Parameter-Efficient Finetuning</small>
- μ „μ²΄ λ¨λΈμ„ νμΈνλ‹ν•λ” κ²ƒμ€ μ „μ²΄ νμΈνλ‹<small>full finetuning</small>μ΄λΌν•λ‹¤.
- κΈ°μ μ΄ νλΌλ―Έν„° ν¨μ¨μ μ΄λΌλ” κ²ƒμ€ μ „μ²΄ νμΈνλ‹λ³΄λ‹¤ μ μ€ κ·λ¨μ ν•™μµ νλΌλ―Έν„°λ΅ μ μ‚¬ν• μ„±λ¥μ„ λ‹¬μ„±ν•  μ μλ‹¤λ” κ²ƒμ„ μλ―Έν•λ‹¤.
- PEFTλ” [Houlsby et al., 2019](https://arxiv.org/abs/1902.00751)μ— μν•΄ μ†κ°λμ–΄, λ¨λΈμ μ¬λ°”λ¥Έ μ„μΉμ— μ¶”κ°€μ μΈ νλΌλ―Έν„°λ¥Ό μ‚½μ…ν•λ©΄ μ μ€ ν›λ ¨ νλΌλ―Έν„°λ΅ κ°•λ ¥ν• νμΈνλ‹ μ„±λ¥μ„ λ‹¬μ„±ν•  μ μμμ„ λ³΄μ€λ‹¤.
    <div style="text-align: center;"><img src="{{ "/assets/img/posts/study/ai-engineering/chapter7-8/figure7-8.png" | relative_url }}" width="540px"/></div>
- <mark>PEFT λ™μ• λ¨λΈμ λ³Έλ νλΌλ―Έν„°λ” κ³ μ •ν•μ±„ μ–΄λ‘ν„°<small>adapters</small>λ§ μƒλ΅­κ² μμ •ν•λ‹¤.</mark> ν›λ ¨ νλΌλ―Έν„°λ” μ–΄λ‘ν„° νλΌλ―Έν„° μλ‹¤.
- <mark>PEFTμ λ‹¨μ μ€ νμΈνλ‹ν• λ¨λΈμ μ¶”λ΅  μ§€μ—°μ„ μ¦κ°€μ‹ν‚¨λ‹¤λ” μ μ΄λ‹¤.</mark> μ–΄λ‘ν„°κ°€ μ¶”κ°€μ μΈ λ μ΄μ–΄λ¥Ό λ„μ…ν•μ—¬, μλ°©ν–¥ μ „λ‹¬ μ‹ μ¶”κ°€μ μΈ κ³„μ‚° λ‹¨κ³„λ¥Ό λ§λ“¤κ³  μ¶”λ΅ μ„ λλ¦¬κ²ν•λ‹¤.

##### PEFT κΈ°μ 
- PEFTλ” μ£Όλ΅ 2κ°€μ§€ λ°©λ²•μΌλ΅ λ‚λ‰λ‹¤: μ–΄λ‘ν„° κΈ°λ°<small>adapter-based</small>κ³Ό μ†ν”„νΈ ν”„λ΅¬ν”„νΈ κΈ°λ°<small>soft prompt-based</small> λ°©λ²•
    - μ–΄λ‘ν„° κΈ°λ° λ°©λ²•μ€ λ¨λΈ κ°€μ¤‘μΉμ— μ¶”κ°€μ μΈ λ¨λ“μ„ λ„μ…ν•λ” λ¨λ“  λ°©λ²•μ΄λ‹¤.
    - μ†ν”„νΈ ν”„λ΅¬ν”„νΈλ” μ‚¬λμ΄ μ½κΈ° μ–΄λ ¤μ΄ μ—°μ†μ μΈ λ²΅ν„° ν•νƒμ ν”„λ΅¬ν”„νΈλ΅ λ¨λΈμ ν–‰λ™μ„ κµμ •ν•λ‹¤.

##### LoRA
- <mark>LoRA<small>Low-Rank Adaptation</small> (<a href="https://arxiv.org/abs/2106.09685">Hu et al., 2021</a>)λ” μ¶”κ°€μ μΈ μ¶”λ΅  μ§€μ—° μ—†μ΄ μƒλ΅μ΄ νλΌλ―Έν„°λ¥Ό μµν•©ν•λ” λ°©λ²•μ΄λ‹¤.</mark>
- κ°€μ¤‘μΉ ν–‰λ ¬ $$ W $$μ μ°¨μ›μ΄ $$ n \times m $$μΌ λ•, LoRAμ λ™μ‘μ€ λ‹¤μκ³Ό κ°™λ‹¤:
    1. μƒλ΅ λ§λ“¤ μ‘μ€ ν–‰λ ¬λ“¤μ μ°¨μ›μ„ μ„ νƒν•λ‹¤. LoRA *rank*μΈ $$ r $$μ„ μ„ νƒν•λ©΄ 2κ°μ ν–‰λ ¬μ„ λ§λ“¤ μ μλ‹¤. $$ A $$(μ°¨μ› $$ n \times r $$)κ³Ό $$ B $$(μ°¨μ› $$ r \times m $$)μ΄λ‹¤. λ‘ ν–‰λ ¬μ κ³±μ€ $$ W_{AB} $$λ΅ $$ W $$μ™€ λ™μΌν• μ°¨μ›μ„ κ°€μ§„λ‹¤.
    2. $$ W_{AB} $$λ¥Ό λ³Έλ κ°€μ¤‘μΉ ν–‰λ ¬μΈ $$ W $$μ— λ”ν•΄ μƒλ΅μ΄ κ°€μ¤‘μΉ ν–‰λ ¬ $$ W' $$μ„ λ§λ“ λ‹¤. $$ W' $$λ¥Ό $$ W $$ μλ¦¬μ— λ¨λΈμ μΌλ¶€λ΅ μ„μΉμ‹ν‚¨λ‹¤. ν•μ΄νΌνλΌλ―Έν„° $$ \alpha $$λ¥Ό μ‚¬μ©ν•΄ $$ W_{AB} $$κ°€ μƒλ΅μ΄ ν–‰λ ¬μ— μ–Όλ§λ‚ μν–¥μ„ λ―ΈμΉ μ§€ μ„¤μ •ν•  μ μλ‹¤. $$ W' = W + {\alpha \over r} W_{AB} $$
    3. νμΈνλ‹μ—μ„ μ¤μ§ $$ A, B $$μ νλΌλ―Έν„°λ§ μƒλ΅­κ² μμ •ν•λ‹¤. $$ W $$λ” μ μ§€ν•λ‹¤.

<div style="text-align: center;"><img src="{{ "/assets/img/posts/study/ai-engineering/chapter7-8/figure7-11.png" | relative_url }}" width="540px"/></div>

##### LoRAκ°€ λ™μ‘ν•λ” μ΄μ 
- λ§μ€ λ…Όλ¬Έμ—μ„ LLMμ€ λ§μ€ νλΌλ―Έν„°λ¥Ό μ§€λ‹μ§€λ§, λ§¤μ° μ μ€ λ‚΄μ¬ μ°¨μ›μ„ μ§€λ‹λ‹¤λ” μ μ„ μ£Όμ¥ν•λ‹¤. ([Li et al., 2018](https://arxiv.org/abs/1804.08838), [Aghajanyan et al., 2020](https://arxiv.org/abs/2012.13255), [Hu et al.,
2021](https://arxiv.org/abs/2106.09685))
    - μ΄λ” μ‚¬μ „ ν•™μµμ΄ μ•”λ¬΄μ μΌλ΅ λ¨λΈμ λ‚΄μ¬ μ°¨μ›μ„ μµμ†ν™”ν•λ‹¤λ” κ²ƒμ„ λ³΄μ—¬μ¤€λ‹¤.
    - λ” ν° λ¨λΈμ€ μ‚¬μ „ ν•™μµ ν›„ λ” λ‚®μ€ λ‚΄μ¬ μ°¨μ›μ„ μ§€λ‹λ” κ²½ν–¥μ΄ μλ‹¤.
    - μ‚¬μ „ ν•™μµμ€ ν•λ¥ μ‘μ—…μ„ μ„ν• μ••μ¶• ν”„λ μ„μ›ν¬μ²λΌ λ™μ‘ν•λ‹¤κ³  λ³Ό μ μλ‹¤.
    - LLMμ΄ λ” μ ν›λ ¨λ μλ΅, λ” μ μ€ μμ ν›λ ¨ νλΌλ―Έν„°μ™€ λ” μ μ€ μ–‘μ λ°μ΄ν„°λ΅ νμΈνλ‹μ„ λ” μ‰½κ² μν–‰ν•  μ μλ‹¤.
##### LoRA μ„¤μ •
- LoRAμ„ μ μ©ν•λ ¤λ©΄ μ–΄λ–¤ ν–‰λ ¬μ— LoRAλ¥Ό μ μ©ν•κ³  κ° μΈμ λ¶„ν•΄μ— μ–΄λ–¤ rankλ¥Ό μ μ©ν• μ§€ κ²°μ •ν•΄μ•Όν•λ‹¤.

##### LoRA μ–΄λ‘ν„° μ„λΉ™ν•κΈ°
- μΌλ°μ μΌλ΅ LoRAλ΅ νμΈνλ‹ν• λ¨λΈμ„ 2κ°€μ§€ λ°©λ²•μΌλ΅ μ„λΉ™λλ‹¤.
    1. νμΈνλ‹ λ¨λΈ μ„λΉ™ μ΄μ „μ— LoRA κ°€μ¤‘μΉ A, Bλ¥Ό μ›λ³Έ λ¨λΈμ— λ³‘ν•©ν•΄ μƒλ΅μ΄ ν–‰λ ¬ W'λ¥Ό λ§λ“ λ‹¤. μ¶”λ΅  κ³Όμ •μ—μ„ μ¶”κ°€ μ—°μ‚°μ΄ μ—†μΌλ―€λ΅ μ¶”κ°€ μ§€μ—°λ„ μ—†λ‹¤.
    2. μ„λΉ™ κ³Όμ •μ—μ„ W, A, Bλ¥Ό λ¶„λ¦¬ν•μ—¬ μ μ§€ν•λ‹¤. μ¶”λ΅  κ³Όμ •μ—μ„ Wλ΅ A, B ν–‰λ ¬ λ³‘ν•©μ΄ μ΄λ£¨μ–΄μ§€κ³  μ¶”κ°€ μ§€μ—°μ„ μ λ°ν•λ‹¤.
- μ²« λ²μ§Έ μ„ νƒμ§€λ” ν•λ‚μ LoRA λ¨λΈλ§ μμ„ λ• μ ν•©ν•λ‹¤.
- λ‘ λ²μ§Έ μ„ νƒμ§€λ” μ—¬λ¬ LoRA λ¨λΈμ„ μ„λΉ™ν•  λ• λ‚«λ‹¤. μ—¬λ¬ LoRA λ¨λΈμ„ λ™μΌ λ² μ΄μ¤ λ¨λΈμ„ κ³µμ ν• μ±„ μ„λΉ™ν•  μ μλ‹¤.
    <div style="text-align: center;"><img src="{{ "/assets/img/posts/study/ai-engineering/chapter7-8/figure7-12.png" | relative_url }}" width="540px"/></div>
- λ‹¤μ¤‘ LoRA μ„λΉ™ μ‹ λ‘ λ²μ§Έ μ„ νƒμ§€λ” μ¶”λ΅  μ§€μ—°μ„ λλ¦¬μ§€λ§ ν„μ €ν•κ² μ €μ¥μ† μ”κµ¬λ‰μ„ μ¤„μΌ μ μλ‹¤.
    - 100λ…μ κ³ κ°μ„ μ„ν• 100κ°μ νμΈνλ‹ λ¨λΈμ΄ μμ„ κ²½μ° μ²« λ²μ§Έ μ„ νƒμ§€μ—μ„λ” 100κ°μ full-rank ν–‰λ ¬ W'λ¥Ό μ €μ¥ν•΄μ•Όν•λ‹¤. λ‘ λ²μ§Έ μ„ νƒμ§€μ—μ„λ” ν•λ‚μ full-rank ν–‰λ ¬ Wλ¥Ό μ €μ¥ν•κ³  100κ°μ μ‘μ€ ν–‰λ ¬ (A, B)λ¥Ό μ €μ¥ν•λ‹¤.
- λ‘ λ²μ§Έ μ„ νƒμ§€λ” μ‘μ—…κ°„ κµμ²΄λ¥Ό λΉ λ¥΄κ² ν•  μ μλ‹¤. μ „μ²΄ κ°€μ¤‘μΉλ¥Ό μƒλ΅­κ² λ¶λ¬μ¤μ§€ μ•κ³ , μƒλ΅μ΄ λ¨λΈμ LoRA μ–΄λ‘ν„°λ§ λ¶λ¬μ™€ λ΅λ”© μ‹κ°„μ„ ν„μ €ν•κ² μ¤„μΌ μ μλ‹¤.

#### λ¨λΈ λ³‘ν•©κ³Ό λ‹¤μ¤‘ μ‘μ—… νμΈνλ‹
<div style="text-align: center;"><img src="{{ "/assets/img/posts/study/ai-engineering/chapter7-8/figure7-14.png" | relative_url }}" width="540px"/></div>

#### νμΈνλ‹ μ „λµ

### μ”μ•½

## Chatper 8
Dateset Engineering: λ°μ΄ν„°μ…‹ μ—”μ§€λ‹μ–΄λ§

- <mark>λ¨λΈμ ν’μ§μ€ ν›λ ¨ λ°μ΄ν„°μ ν’μ§μ— μμ΅΄ν•λ‹¤.</mark>

<aside mark="π’΅">
AIμ— λ€ν• λ°μ΄ν„° μ¤‘μ‹¬ κ΄€μ 
<ul>
<li>λ¨λΈ μ¤‘μ‹¬ AI<small>model-centric AI</small>: λ¨λΈ μμ²΄λ¥Ό ν–¥μƒμ‹μΌ AI μ„±λ¥μ„ κ°μ„ ν•λ‹¤. μƒλ΅μ΄ μ•„ν‚¤ν…μ², λ¨λΈμ ν¬κΈ° μ¦κ°€, μƒλ΅μ΄ ν›λ ¨ κΈ°μ  κ°λ°μ„ ν¬ν•¨ν•λ‹¤.</li>
<li>λ°μ΄ν„° μ¤‘μ‹¬ AI<small>data-centric AI</small>: λ°μ΄ν„°λ¥Ό ν–¥μƒμ‹μΌ AI μ„±λ¥μ„ κ°μ„ ν•λ‹¤. μƒλ΅μ΄ λ°μ΄ν„° μ²λ¦¬ κΈ°μ  κ°λ°, λ” μ μ€ λ¦¬μ†μ¤λ΅ λ” λ‚μ€ λ¨λΈμ„ ν›λ ¨ν•  μ μλ„λ΅ ν•λ” κ³ ν’μ§ λ°μ΄ν„°μ…‹μ„ λ§λ“λ” κ²ƒμ„ ν¬ν•¨ν•λ‹¤.</li>
<li>λ°μ΄ν„° μ¤‘μ‹¬ λ²¤μΉλ§ν¬λ” κ°™μ€ λ¨λΈμ— λ€ν•΄ λ” λ‚μ€ μ„±λ¥μ„ λ³΄μΌ μ μλ” λ°μ΄ν„°μ…‹μ„ κ°λ°ν•λ” κ²ƒμ„ λ©ν‘λ΅ ν•λ‹¤.</li>
</ul>
</aside>


### λ°μ΄ν„° μ„ λ³„<small>Data Curation</small>
- μ¬λ°”λ¥Έ λ°μ΄ν„°λ” λ¨λΈμ„ λ” μ λ¥ν•κ², μ•μ „ν•κ², λ” κΈ΄ μ»¨ν…μ¤νΈλ¥Ό λ‹¤λ£° μ μκ² ν•λ‹¤.
- λ°μ΄ν„° μ„ λ³„μ€ λ¨λΈμ΄ μ–΄λ–»κ² ν•™μµν•λ”μ§€, ν•™μµμ— λ„μ›€μ΄ λλ” κ°€λ¥ν• μμ›μ΄ μ–΄λ–¤ κ²ƒμΈμ§€μ— λ€ν• μ΄ν•΄κ°€ ν•„μ”ν• κ³Όν•™μ΄λ‹¤.
- ν•„μ”ν• λ°μ΄ν„°λ” ν•κ³ μ ν•λ” μ‘μ—…κ³Ό μ–΄λ–¤ κ±Έ λ¨λΈμ— κ°€λ¥΄μΉκ³  μ‹¶μ€μ§€μ— λ‹¬λ ¤μλ‹¤.
    - μκΈ° μ§€λ„ νμΈνλ‹μ„ μ„ν•΄μ„λ” λ°μ΄ν„° μ‹ν€€μ¤κ°€ ν•„μ”ν•λ‹¤.
    - μ§€μ‹ νμΈνλ‹μ„ μ„ν•΄μ„λ” (μ§€μ‹, μ‘λ‹µ) ν•μ‹μ λ°μ΄ν„°κ°€ ν•„μ”ν•λ‹¤.
    - μ„ νΈλ„ νμΈνλ‹μ„ μ„ν•΄μ„λ” (μ§€μ‹, μ΄κΈ΄ μ‘λ‹µ, μ§„ μ‘λ‹µ) ν•νƒμ λ°μ΄ν„°κ°€ ν•„μ”ν•λ‹¤.
    - λ³΄μƒ λ¨λΈμ„ μ„ν•΄μ„λ” μ„ νΈλ„ νμΈνλ‹κ³Ό κ°™μ€ ν•νƒμ λ°μ΄ν„°λ¥Ό μ΄μ©ν•κ±°λ‚ ((μ§€μ‹, μ‘λ‹µ), μ μ) ν•νƒμ μ£Όμ„ μ²λ¦¬λ μ μ λ°μ΄ν„°λ¥Ό μ΄μ©ν•λ‹¤.
- ν›λ ¨ λ°μ΄ν„°λ” λ¨λΈμ΄ ν•™μµν•κΈ°λ¥Ό μ›ν•λ” ν–‰λ™μ„ λ‚νƒ€λ‚΄μ•Ό ν•λ‹¤.
- CoTμ™€ λ…Όλ¦¬μ  μ‚¬κ³ <small>reasoning</small>λ¥Ό λ¨λΈμ— κ°€λ¥΄μΉλ” κ±΄ λ³µμ΅ν•λ‹¤.
    - Chain-of-Thought: <mark>λ¨λΈμ΄ λ‹¨κ³„λ³„ μ‘λ‹µμ„ μƒμ„±ν•λ„λ΅ κ°€λ¥΄μΉλ ¤λ©΄ ν›λ ¨ λ°μ΄ν„°κ°€ CoT μ‘λ‹µμ„ ν¬ν•¨ν•΄μ•Ό ν•λ‹¤.</mark> [Chun et al., 2024](https://www.jmlr.org/papers/v25/23-0870.html)λ” νμΈνλ‹ λ°μ΄ν„°μ— λ‹¨κ³„λ³„ μ‘λ‹µμ„ ν•©μΉλ” κ²ƒμ΄ CoT μ‘μ—…μ— λ€ν• λ‹¤μ–‘ν• μ‚¬μ΄μ¦μ λ¨λΈμ΄ ν° μ„±λ¥ ν–¥μƒμ„ μ΄λ£¬λ‹¤λ” κ²ƒμ„ λ³΄μ€λ‹¤. μΌλ¶€λ” νΉμ • μ‘μ—…μ— λ€ν•΄ λ‘ λ°°μ μ •ν™•λ„λ¥Ό λ³΄μ€λ‹¤.
        - λ‹¤λ‹¨κ³„ μ‘λ‹µμ„ λ§λ“¤μ–΄λ‚΄λ” κ±΄ μ§€λ£¨ν•κ³  μ‹κ°„ μ†λ¨μ μΌ μ μλ‹¤.<br/>
        <div style="text-align: center;"><img src="{{ "/assets/img/posts/study/ai-engineering/chapter7-8/cot-inst-chun-et-al-2024.png" | relative_url }}" width="540px"/></div>
        - μ΄λ΅ μΈν•΄ CoT λ°μ΄ν„°μ…‹μ€ λ‹¤λ¥Έ μ§€μ‹ λ°μ΄ν„°μ…‹μ— λΉ„ν•΄ ν”ν•μ§€ μ•λ‹¤.
    - Tool use: μ‚¬μ „ ν•™μµμ—μ„ νλ“ν• λ§μ€ μ–‘μ μ§€μ‹μΌλ΅ λ§μ€ λ¨λΈμ€ λ³Έλ¥μ μΌλ΅ μ–΄λ–¤ λ„κµ¬λ¥Ό μ‚¬μ©ν•  μ§€ μ• μ μλ‹¤.
        - <mark>λ¨λΈμ λ„κµ¬ μ‚¬μ© λ¥λ ¥μ€ λ„κµ¬ μ‚¬μ© μμ‹λ¥Ό λ³΄μ—¬μ¤μΌλ΅μ¨ ν–¥μƒν•  μ μλ‹¤.</mark>
        - λ„κµ¬ μ‚¬μ© λ°μ΄ν„°λ¥Ό λ§λ“¤μ–΄λ‚΄λ” λ°μ—λ” λ„λ©”μΈ μ „λ¬Έκ°€λ¥Ό μ΄μ©ν•λ”κ² μΌλ°μ μ΄λ‹¤. κ° ν”„λ΅¬ν”„νΈλ” λ„κµ¬ μ‚¬μ©μ„ ν•„μ”λ΅ ν•λ” μ‘μ—…μ΄λ©°, μ‘λ‹µμ€ μ‘μ—…μ„ μν–‰ν•κΈ° μ„ν•΄ ν•„μ”ν• λ™μ‘μ΄λ‹¤.
        - μ‚¬λμ΄ μ‘μ—…μ„ μ–΄λ–»κ² μν–‰ν•λ”μ§€ κ΄€μ°°ν•λ” κ²ƒμ€ μ •ν™•μ„±μ„ μ„ν•΄ μΆ…μΆ… ν•„μ”ν•λ‹¤.
        - AI μ—μ΄μ „νΈμ λ„κµ¬ μ‚¬μ© λ°©μ‹μ€ μ‚¬λκ³Ό λ‹¤λ¥Ό μ μμΌλ―€λ΅ λ„κµ¬ μ‚¬μ© λ°μ΄ν„° μƒμ„±μ€ λ§μ€ κ²½μ° μ‹λ®¬λ μ΄μ…κ³Ό ν•©μ„± κΈ°μ μ— μμ΅΄ν•λ‹¤.
        - [Dubey et al., 2024](https://arxiv.org/abs/2407.21783)μ—μ„ Llama 3 μ €μλ“¤μ€ λ‹¤μ¤‘ λ©”μ‹μ§€ μ±„ν… ν•μ‹μ„ μ„¤κ³„ν–λ‹¤. μ΄λ” κ° λ©”μ‹μ§€μ μ¶λ°μ§€μ™€ λ„μ°©μ§€λ¥Ό κµ¬μ²΄ν™”ν•λ” λ©”μ‹μ§€ ν—¤λ”, κ·Έλ¦¬κ³  μ‚¬λκ³Ό AI μμ„κ°€ μ–΄λ””μ„ μ‹μ‘λλ”μ§€ κµ¬μ²΄ν™”ν•λ” νΉλ³„ν• μΆ…λ£ ν† ν°μΌλ΅ κµ¬μ„±λμ–΄μλ‹¤.
- λ€ν™”ν• μΈν„°νμ΄μ¤μ μ•±μ„ μ„ν•΄ λ°μ΄ν„° μ„ λ³„μ„ ν•λ ¤λ©΄ single-turn, multi-turn λ°μ΄ν„° λλ” λ‘λ‹¤ ν•„μ”ν•μ§€ κ³ λ ¤ν•΄μ•Όν•λ‹¤.
    - single-turn λ°μ΄ν„°λ” κ°λ³„ μ§€μ‹μ— μ‘λ‹µν•λ„λ΅ λ¨λΈμ„ ν›λ ¨ν•  μ μλ‹¤.
    - multi-turn λ°μ΄ν„°λ” λ¨λΈμ΄ μ‘μ—…μ„ ν•΄κ²°ν•λ„λ΅ κ°€λ¥΄μΉ  μ μλ‹¤. λ§μ€ μ‹¤μ  μ„Έκ³„μ μ‘μ—…μ€ μƒνΈκµν™μ μΈ κ³Όμ •μ„ ν¬ν•¨ν•κΈ° λ•λ¬Έμ΄λ‹¤. μλ΅, μ£Όμ–΄μ§„ μ§μμ— λ€ν•΄ λ¨λΈμ€ μ‘μ—…μ„ ν•΄κ²°ν•κΈ°μ— μ•μ„ μ‚¬μ©μμ μλ„λ¥Ό λ…ν™•νν•΄μ•Όν•  μ μλ‹¤. λ¨λΈ μ‘λ‹µ μ΄ν›„, μ‚¬μ©μλ” λ‹¤μ λ‹¨κ³„λ¥Ό μ„ν•΄ μμ •μ΄λ‚ μ¶”κ°€ μ •λ³΄λ¥Ό μ κ³µν•  μ μλ‹¤.
    - multi-turn λ°μ΄ν„°λ” μΆ…μΆ… μ΄λ¥Ό ν¬μ°©ν•κΈ° μ„ν•΄ λ©μ μ— λ§κ² μ„¤κ³„λ μ‹λ‚λ¦¬μ¤λ‚ λ” λ³µμ΅ν• μƒνΈμ‘μ©μ„ ν•„μ”λ΅ ν•λ‹¤.
- <mark>λ°μ΄ν„° μ„ λ³„μ€ λ¨λΈμ΄ μƒλ΅μ΄ ν–‰λ™μ„ λ°°μ°λ„λ΅ μƒλ΅μ΄ λ°μ΄ν„°λ¥Ό λ§λ“λ” κ²ƒλΏλ§ μ•„λ‹λΌ λ¨λΈμ΄ λ‚μ ν–‰λ™μ„ λ°°μ°μ§€ μ•λ„λ΅ μ΅΄μ¬ν•λ” λ°μ΄ν„°λ¥Ό μ κ±°ν•λ” κ³Όμ •λ„ ν¬ν•¨ν•λ‹¤.</mark>
- κ±°μ‹μ  κ΄€μ μ—μ„ <mark>λ°μ΄ν„° μ„ λ³„μ€ λ°μ΄ν„° ν’μ§, λ°μ΄ν„° ν¬κ΄„μ„±, λ°μ΄ν„° μ–‘μ 3κ°€μ§€ κΈ°μ¤€μ— λ”°λ¥Έλ‹¤.</mark>

#### λ°μ΄ν„° ν’μ§
- <mark>μ μ€ μ–‘μ κ³ ν’μ§ λ°μ΄ν„°λ” λ§μ€ μ–‘μ μ΅μ κ°€λ“ν• λ°μ΄ν„°λ³΄λ‹¤ μΆ‹μ€ μ„±λ¥μ„ λ‚Ό μ μλ‹¤.</mark>
- [LIMA: Less Is More for Alignment](https://arxiv.org/abs/2305.11206)λ” 65B νλΌλ―Έν„° Llama λ¨λΈμ„ μ„¬μ„Έν•κ² μ„ λ³„ν• ν”„λ΅¬ν”„νΈμ™€ μ‘λ‹µ 1,000κ°λ¥Ό μ΄μ©ν•΄ νμΈνλ‹ν•΄, μ‚¬μ©μλ“¤λ΅λ¶€ν„° GPT-4λ³΄λ‹¤ 43%μ κ²½μ° μ„ νΈλκ² λ§λ“¤μ—λ‹¤. ν•μ§€λ§ λ„λ¬΄ μ μ€ μμ λ” LIMAκ°€ μ ν’ μμ¤€μ λ¨λΈλ§νΌ κ°•κ±΄<small>robust</small>ν•μ§€ μ•κ² λ§λ“¤μ—λ‹¤.
    - [Llama 3 ν€](https://arxiv.org/abs/2407.21783)μ€ κ³ ν’μ§μ— λ€ν• ν™•μ‹ μ„ μ„ν•΄ AI λ³΄μ΅° μ£Όμ„ λ„κµ¬λ¥Ό κ°λ°ν–λ‹¤.
- λ°μ΄ν„°μ— μμ–΄ κ³ ν’μ§μ΄λ€ μ‘μ—…μ„ ν¨μ¨μ μ΄κ³  λ―Ώμ„ μ μκ² μν–‰ν•λ„λ΅ λ„μ›€μ„ μ¤„ μ μλ” μ„±μ§μ΄λ‹¤.
- <mark>λ°μ΄ν„°μ κ³ ν’μ§ μ—¬λ¶€λ” 6κ°€μ§€ νΉμ„±μ„ λ”°λ¥Έλ‹¤: κ΄€λ ¨μ„±, μ‘μ—… μ”κµ¬ μ‚¬ν•­κ³Όμ μ •ν•©μ„±, μΌκ΄€μ„±, μ¬λ°”λ¥Έ ν•μ‹, κ³ μ μ„±, κ·μ • μ¤€μ</mark>
    - κ΄€λ ¨μ„±<small>relevant</small>: ν•™μµ μμ λ” λ¨λΈμ΄ μν–‰ν•λ ¤λ” μ‘μ—…κ³Ό κ΄€λ ¨μμ–΄μ•Ό ν•λ‹¤.
    - μ‘μ—… μ”κµ¬ μ‚¬ν•­κ³Όμ μ •ν•©μ„±<small>aligned with taask requirements</small>: μ£Όμ„μ€ μ‘μ—… μ”κµ¬ μ‚¬ν•­κ³Ό μ •ν•©ν•΄μ•Όν•λ‹¤. μ‘μ—…μ΄ μ‚¬μ‹¤μ  μΌκ΄€μ„±μ„ ν•„μ”λ΅ ν•λ©΄, μ£Όμ„λ„ μ‚¬μ‹¤μ μΌλ΅ μ³μ•„μ•Όν•λ‹¤.
    - μΌκ΄€μ„±<small>consistent</small>: μ£Όμ„μ€ μμ μ™€ λ°μ΄ν„° μ£Όμ„κ°€<small>annotators</small> κ°„μ— μΌκ΄€μ μ΄μ–΄μ•Όν•λ‹¤.
    - μ¬λ°”λ¥Έ ν•μ‹<small>correctly formatted</small>: λ¨λ“  μμ λ” λ¨λΈμ΄ μμƒν•λ” ν•μ‹μ„ μ¤€μν•΄μ•Ό ν•λ‹¤.
    - κ³ μ μ„±<small>unique</small>: λ°μ΄ν„°μ— ν¬ν•¨λ κ³ μ ν• μμ  μκ°€ λ§μ•„μ•Όν•λ‹¤. λ¨λΈ ν›λ ¨μ— μμ–΄μ„ μ¤‘λ³µ λ°μ΄ν„°λ” νΈκ²¬μ„ λ§λ“¤κ³  λ°μ΄ν„° μ¤μ—Όμ„ λ°μƒμ‹ν‚¬ μ μλ‹¤.
    - κ·μ • μ¤€μ<small>compliant</small>: λ°μ΄ν„°λ” λ²•κ³Ό κ·μ λ¥Ό ν¬ν•¨ν•μ—¬ λ‚΄μ™Έλ¶€ μ •μ±…μ„ μ¤€μν•΄μ•Όν•λ‹¤.

#### λ°μ΄ν„° ν¬κ΄„μ„±<small>Data Coverage</small>
- <mark>λ¨λΈμ ν›λ ¨ λ°μ΄ν„°λ” λ¨λΈμ΄ ν•΄κ²°ν•΄μ•Όν•  λ¬Έμ μ λ²”μ„μ„ ν¬κ΄„ν•΄μ•Όν•λ‹¤.</mark>
- ν¬κ΄„μ„±μ€ μ¶©λ¶„ν• λ°μ΄ν„° λ‹¤μ–‘μ„±μ„ μ”κµ¬ν•λ‹¤.
- μ‚¬μ©μ μ§μμ— ν”ν μ¤νƒ€κ°€ μλ‹¤λ©΄, μ¤νƒ€κ°€ μλ” μμ λ¥Ό ν¬ν•¨ν•΄μ•Ό ν•λ‹¤.
- λ‹¤λ¥Έ μ•±μ€ λ‹¤λ¥Έ μ°¨μ›μ λ‹¤μ–‘μ„±μ„ μ§€λ‹λ‹¤. μλ΅, ν”„λ‘μ¤-μμ–΄ λ²μ—­ λ„κµ¬λ” μ–Έμ–΄ λ‹¤μ–‘μ„±μ΄ ν•„μ”ν•μ§€ μ•μ§€λ§, μ£Όμ μ™€ κΈΈμ΄ λ° λ°ν™” μ–‘μ‹ λ‹¤μ–‘μ„±μ„ μ§€λ…€μ•Όν•λ‹¤.
- μ±—λ΄‡ κ°™μ€ λ²”μ© μ©λ΅€μ κ²½μ°, νμΈνλ‹ λ°μ΄ν„°λ” λ„“μ€ λ²”μ„μ μ£Όμ μ™€ λ°ν™” μ ν•μ„ ν¬ν•¨ν•λ„λ΅ λ‹¤μ–‘ν•΄μ•Όν•λ‹¤.
- [Adler et al., 2024](https://arxiv.org/abs/2406.11704)μ—μ„ NVDIA μ—°κµ¬μλ“¤μ€ μ‘μ—…, μ£Όμ  λ° μ§€μ‹ λ‹¤μ–‘μ„±μ„ μ§€λ‹κ³  λ‹¤λ¥Έ μ¶λ ¥ ν•μ‹, λ‹¤λ¥Έ μ¶λ ¥ κΈΈμ΄, μ—΄λ¦° κ²°λ§ μ‘λ‹µκ³Ό μ-μ•„λ‹μ¤ μ‘λ‹µμ„ ν¬ν•¨ν• λ°μ΄ν„°μ…‹μ„ λ§λ“λ”λ° μ§‘μ¤‘ν–λ‹¤.
    - [Shen et al., 2024](https://www.arxiv.org/abs/2408.04154)μ—μ„λ” μΌλ¶€ κ²½μ°, μ΄μ§μ μΈ λ°μ΄ν„°λ¥Ό λ”ν•  μλ΅ μ„±λ¥μ΄ μ•…ν™”λλ” κ±Έ λ°κ²¬ν–λ‹¤.
- [Llama 3](https://arxiv.org/abs/2407.21783)μ μ„±λ¥ ν–¥μƒμ€ ν›λ ¨ κ·λ¨ μ¦κ°€ λΏλ§ μ•„λ‹λΌ μ£Όλ΅ λ°μ΄ν„° ν’μ§κ³Ό λ‹¤μ–‘μ„±μ— μν• κ²ƒμ΄μ—λ‹¤. ν•΄λ‹Ή λ…Όλ¬Έμ—μ„ κΈ°μ λ μ‚¬μ „ ν›λ ¨, μ§€λ„ νμΈνλ‹, μ„ νΈλ„ νμΈνλ‹μ— λ”°λ¥Έ λ°μ΄ν„° ν¬κ΄„μ„± μƒμ„Έμ λ°μ΄ν„° νΌν•©μ„ λ³΄λ” κ²ƒμ€ μ μ©ν•λ‹¤.
    <div style="text-align: center;"><img src="{{ "/assets/img/posts/study/ai-engineering/chapter7-8/table8-1.png" | relative_url }}" width="540px"/></div>
    - Llama 3μ λλ‹¤λ¥Έ λ‹¤μ–‘μ„± μ°¨μ›μ€ μ‚¬λμ΄ μƒμ„±ν• λ°μ΄ν„°μ™€ AIκ°€ μƒμ„±ν• λ°μ΄ν„°μ λΉ„μ¨μ΄λ‹¤.
    - <mark>κ³ ν’μ§μ μ½”λ“μ™€ μν•™ λ°μ΄ν„°λ” μμ—°μ–΄ ν…μ¤νΈλ³΄λ‹¤ λ¨λΈμ λ…Όλ¦¬μ  μ‚¬κ³  λ¥λ ¥μ„ ν–¥μƒμ‹ν‚¤λ”λ° ν¨κ³Όμ μ΄λ‹¤.</mark>
    - μ„ νΈλ„ νμΈνλ‹μ λ°μ΄ν„° νΌν•©μ€ μ‚¬μ©μμ μ‹¤μ  μ„ νΈ λ¶„ν¬μ— λ”°λΌ μ½”λ“μ™€ μν•™ λ°μ΄ν„°κ°€ λ” μ λ‹¤.
- μ¬λ°”λ¥Έ λ°μ΄ν„° νΌν•©μ€ μ‹¤μ  μ•± μ‚¬μ©μ„ μ •ν™•ν λ°μν•λ” κ² μΆ‹λ‹¤. μµμ μ λ°μ΄ν„° νΌν•©μ„ μ°ΎκΈ° μ„ν•΄ μ‹¤ν—μ„ μν–‰ν•  μ μλ‹¤.
- <mark>2μ¥μ μ¤μΌ€μΌλ§ μ™Έμ‚½μ²λΌ μ‘μ€ λ¨λΈμ„ νΉμ • λ°μ΄ν„° νΌν•©μ— λ”°λΌ ν›λ ¨μ‹ν‚¤κ³  ν•΄λ‹Ή νΌν•©μ— λ€ν• λ€ν• λ¨λΈμ μ„±λ¥μ„ μμΈ΅ν•  μ μλ‹¤.</mark>
- [LIMA: Less Is More for Alignment](https://arxiv.org/abs/2305.11206)λ” λ°μ΄ν„° λ‹¤μ–‘μ„±κ³Ό ν’μ§μ μν–¥λ„λ¥Ό ν‰κ°€ν–λ‹¤.
    <div style="text-align: center;"><img src="{{ "/assets/img/posts/study/ai-engineering/chapter7-8/figure8-1.png" | relative_url }}" width="540px"/></div>

#### λ°μ΄ν„° μ–‘
- ν•„μ”ν• λ°μ΄ν„° μ–‘μ€ μƒν™©μ— λ”°λΌ λ‹¤λ¥΄λ‹¤.
    - [Jeremy Howardμ™€ Jonathan Whitaker](https://www.fast.ai/posts/2023-09-04-learning-jumps/)λ” λ‹¨ ν•λ‚μ μμ λ΅ LLMμ„ νμΈνλ‹ν–λ‹¤.
    - λ‹¤λ¥Έ ν€μ€ λ°±λ§κ°μ μμ λ΅ νμΈνλ‹ν•κΈ°λ„ ν–λ‹¤.
- νμΈνλ‹μ€ λ€κ° μ‚¬μ „ν•™μµ λ¨λΈμ„ λ°”νƒ•μΌλ΅ ν•λ” κ² ν¨κ³Όμ μ΄μ§€λ§, ν›λ ¨ λ°μ΄ν„°κ°€ λ§μΌλ©΄ μ²μλ¶€ν„° μ‚¬μ „ν•™μµν•λ” κ² λ‚μ„ μ μλ‹¤. <mark>μ΄λ” κ³ μ°©ν™”<small>ossification</small> ν„μƒμΌλ΅ μ‚¬μ „ ν•™μµμ΄ λ¨λΈ κ°€μ¤‘μΉλ¥Ό κ³ μ •μ‹μΌμ„ νμΈνλ‹μ΄ μ μ§„ν–‰λμ§€ μ•λ” ν„μƒμ„ μλ―Έν•λ‹¤.</mark> μ‘μ€ λ¨λΈμ΄ ν° λ¨λΈλ³΄λ‹¤ κ³ μ°©ν™”μ— μν–¥λ°›κΈ° μ‰½λ‹¤.
- ν•„μ”ν• λ°μ΄ν„° μ–‘μ€ λ‹¤μ μ”μ†μ— λ”°λ¥Έλ‹¤:
    - <mark>νμΈνλ‹ κΈ°μ </mark>: μ „μ²΄ νμΈνλ‹μ΄ λ‚μ€ μ„±λ¥μ„ λ³΄μΌ μ μμ§€λ§ LoRA κ°™μ€ PEFTμ— λΉ„ν•΄ ν›¨μ”¬ λ§μ€ λ°μ΄ν„°λ¥Ό μ”κµ¬ν•λ‹¤.
    - <mark>μ‘μ—… λ³µμ΅λ„</mark>: λ‹¨μν• μ‘μ—…μ€ λ³µμ΅ν• μ‘μ—…μ— λΉ„ν•΄ ν›¨μ”¬ μ μ€ λ°μ΄ν„°λ¥Ό μ”κµ¬ν•λ‹¤.
    - <mark>λ² μ΄μ¤ λ¨λΈμ μ„±λ¥</mark>: λ² μ΄μ¤ λ¨λΈμ μ›ν•λ” μ„±λ¥μ— κ°€κΉμΈμλ΅ μ μ€ μμ κ°€ ν•„μ”ν•λ‹¤. λ¨λΈμ΄ ν΄μλ΅ μ„±λ¥μ΄ μΆ‹λ‹¤κ³  κ°€μ •ν•λ©΄, λ€ν• λ¨λΈμ„ νμΈνλ‹ν•  λ•λ” λ³΄λ‹¤ μ μ€ μμ κ°€ ν•„μ”ν•λ‹¤.
    <div style="text-align: center;"><img src="{{ "/assets/img/posts/study/ai-engineering/chapter7-8/figure8-2.png" | relative_url }}" width="540px"/></div>
- μ”μ•½ν•μλ©΄, <mark>λ°μ΄ν„° μ–‘μ΄ μ μΌλ©΄ λ³΄λ‹¤ κ³ κΈ‰ λ¨λΈμ— PEFTλ¥Ό μ‚¬μ©ν•λ” κ² λ‚«λ‹¤. μ–‘μ΄ λ§μΌλ©΄ μ‘μ€ λ¨λΈμ„ μ „μ²΄ νμΈνλ‹ν•λ” κ² λ‚«λ‹¤.</mark>
- μ μ€ μ •κµν•κ² λ§λ“¤μ–΄μ§„ λ°μ΄ν„°μ…‹(μλ¥Ό λ“¤λ©΄, 50κ° μ •λ„)μ„ μ΄μ©ν•΄ νμΈνλ‹μ΄ λ¨λΈμ„ ν–¥μƒμ‹ν‚¤λ”μ§€ λ¨Όμ € ν™•μΈν•λΌ.
    - <mark>λ€λ‹¤μμ κ²½μ° 50-100κ°μ μμ λ¥Ό μ΄μ©ν• νμΈνλ‹μΌλ΅ μ„±λ¥ ν–¥μƒμ„ κ΄€μ°°ν•  μ μλ‹¤.</mark>
<!-- 375 -->

#### λ°μ΄ν„° νλ“κ³Ό μ£Όμ„<small>Data Acquistion and Annotation</small>
- λ°μ΄ν„° νλ“μ λ©ν‘λ” ν•„μ”ν• ν’μ§κ³Ό λ‹¤μ–‘μ„±μ λ°μ΄ν„°λ¥Ό μ§€λ‹ μ¶©λ¶„ν ν° λ°μ΄ν„°μ…‹μ„ μƒμ‚°ν•λ” κ²ƒμ΄λ‹¤. μ΄ κ³Όμ •μ—μ„ λ°μ΄ν„° κ΄€ν–‰μ€ μ‚¬μ©μ κ°μΈμ •λ³΄λ¥Ό λ³΄νΈν•κ³  κ·μ •μ„ μ¤€μν•΄μ•Όν•λ‹¤.
- <mark>κ°€μ¥ μ¤‘μ”ν• λ°μ΄ν„° μ¶μ²λ” λ€κ° μ•± μμ²΄μ—μ„ μƒμ„±ν• λ°μ΄ν„°λ‹¤.</mark>
    - μ•± λ°μ΄ν„°λ” ν•κ³ μ ν•λ” μ‘μ—…μ— μ™„λ²½ν κ΄€λ ¨μκ³  μ •ν•©ν•λ‹¤λ” μ μ—μ„ μ΄μƒμ μ΄λ‹¤.
    - μ‚¬μ©μ μƒμ„± λ°μ΄ν„°λ” μ‚¬μ©μ μ»¨ν…μΈ , μ‚¬μ©μμ μ‚¬μ©μΌλ΅ λ¶€ν„° μƒμ„±λ μ‹μ¤ν… λ°μ΄ν„°, μ μ € ν”Όλ“λ°±μ΄ μμ„ μ μλ‹¤.
- μμ²΄ λ°μ΄ν„° μƒμ„± μ „μ— μ¤ν” μ†μ¤μ™€ λ…μ  λ°μ΄ν„°λ¥Ό ν¬ν•¨ν• λ‹¤μ–‘ν• λ°μ΄ν„° μ‹μ¥μ„ λ¨Όμ € μ‚΄ν΄λ³΄λΌ.

### λ°μ΄ν„° μ¦κ°• λ° ν•©μ„±
- λ°μ΄ν„° μ¦κ°•<small>data augmentation</small>: μ΅΄μ¬ν•λ” μ‹¤μ  λ°μ΄ν„°λ΅λ¶€ν„° μƒλ΅μ΄ λ°μ΄ν„°λ¥Ό λ§λ“λ” κ³Όμ •
- λ°μ΄ν„° ν•©μ„±<small>data synthesis</small>: μ‹¤μ  λ°μ΄ν„°μ μ†μ„±μ„ λ¨λ°©ν•λ” λ°μ΄ν„°λ¥Ό μƒμ„±ν•λ” κ³Όμ •

#### μ™ λ°μ΄ν„° ν•©μ„±μ„ ν• κΉ?
- λ°μ΄ν„° ν’μ§, ν¬κ΄„μ„±, μ–‘μ„ μ„ν•΄ λ°μ΄ν„° ν•©μ„±μ„ ν•λ‹¤.
- λ°μ΄ν„° μ–‘μ„ λλ¦¬κΈ° μ„ν•΄
    - λ°μ΄ν„° ν•©μ„±μ΄ AI λ¨λΈμ ν›λ ¨κ³Ό μ‹ν—μ„ μ„ν• μ¶©λ¶„ν• λ°μ΄ν„°λ¥Ό ν° κ·λ¨λ΅ μƒμ„±ν•  μ μκ² ν•λ‹¤λ” μ μ΄ κ°€μ¥ ν° μ΄μ λ‹¤.
- λ°μ΄ν„° ν¬κ΄„μ„±μ„ λλ¦¬κΈ° μ„ν•΄
    - λ¨λΈ μ„±λ¥μ„ ν–¥μƒμ‹ν‚¤κ±°λ‚ νΉμ • ν–‰λ™μ„ ν‘ν„ν•λ„λ΅ μ λ„ν•κΈ° μ„ν•΄ λ©ν‘ν• νΉμ„±μ„ μ§€λ‹ λ°μ΄ν„°λ¥Ό μƒμ„±ν•  μ μλ‹¤.
- λ°μ΄ν„° ν’μ§μ„ ν–¥μƒμ‹ν‚¤κΈ° μ„ν•΄
    - μΆ…μΆ… μ‚¬λμ κ·Όλ³Έμ μΈ ν•κ³„λ΅ μΈν•΄ AI μƒμ„± λ°μ΄ν„°λ³΄λ‹¤ μ‚¬λ μƒμ„± λ°μ΄ν„°κ°€ μ €ν’μ§μ„ μ§€λ‹ μ μλ‹¤. λ„κµ¬ μ‚¬μ©μ΄ κ·Έ μλ΅, μ‚¬λκ³Ό AIλ” λ™μ‘κ³Ό λ„κµ¬ μ„ νΈκ°€ κ·Όλ³Έμ μΌλ΅ λ‹¤λ¥΄λ‹¤.
- κ°μΈ μ •λ³΄ κ±±μ •μ„ μƒμ‡„ν•κΈ° μ„ν•΄
    - κ°μΈ μ •λ³΄ λ¬Έμ λ΅ μ‚¬λμ΄ μƒμ„±ν• λ°μ΄ν„°λ¥Ό μ‚¬μ©ν•  μ μ—†μ„ λ• ν•©μ„± λ°μ΄ν„°λ” μ μΌν• μ„ νƒμ§€λ‹¤.
- λ¨λΈμ„ μ¦λ¥ν•κΈ° μ„ν•΄
    - μΆ…μΆ… μ €λ ΄ν•κ±°λ‚ λΉ λ¥Έ λ¨λΈμ„ μ›λ³Έ λ¨λΈκ³Ό κ²¬μ¤„λ§ν• μ„±λ¥μΌλ΅ λ§λ“¤κΈ° μ„ν•΄ λ°μ΄ν„° ν•©μ„±μ„ μ‚¬μ©ν•λ‹¤.

#### μ „ν†µμ μΈ λ°μ΄ν„° ν•©μ„± κΈ°μ 
##### κ·μΉ™ κΈ°λ° λ°μ΄ν„° ν•©μ„±
- μ‚¬μ „ μ •μλ κ·μΉ™κ³Ό μ–‘μ‹μ„ μ΄μ©ν•΄ λ°μ΄ν„°λ¥Ό μƒμ„±ν•λ” λ°©λ²•μ΄λ‹¤.

##### μ‹λ®¬λ μ΄μ…
- κ°€μƒ ν™κ²½μ—μ„ μ‹¤ν—μ„ μ§„ν–‰ν•μ—¬ λ°μ΄ν„°λ¥Ό μƒμ„±ν•λ” λ°©μ‹μ΄λ‹¤.
    - [Waymoμ SimulationCity](https://waymo.com/blog/2021/07/simulation-city/) κ°™μ€ μμ¨ μ£Όν–‰ μ‹λ®¬λ μ΄μ…μ΄ μλ‹¤.

#### AI κΈ°λ° λ°μ΄ν„° ν•©μ„±
- AIλ” νΉμ • ν”„λ΅κ·Έλ¨μ μ¶λ ¥μ„ μ‹λ®¬λ μ΄μ…ν•  μ μλ‹¤.
    - [StableToolBench](https://arxiv.org/abs/2403.07714)λ” AIλ¥Ό μ΄μ©ν•΄ APIλ¥Ό μ‹¤μ λ΅ νΈμ¶ν•μ§€ μ•κ³  μ‹λ®¬λ μ΄μ…ν•λ” λ°©λ²•μ„ λ³΄μ—¬μ¤€λ‹¤.

##### μ§€μ‹ λ°μ΄ν„° ν•©μ„±
- μ§€μ‹ λ°μ΄ν„° μƒμ„±: λ‹Ήμ‹ μ μ©λ΅€λ¥Ό ν¬κ΄„ν•κΈ° μ„ν•΄ λ‹¤μ–‘ν• μ£Όμ , ν‚¤μ›λ“ λ° μ§€μ‹ μ ν•μ λ©λ΅μ— λ€ν•΄ μ§€μ‹λ¥Ό ν•©μ„±ν•  μ μλ‹¤.
- λ‹µλ³€ ν•©μ„±: μ§€μ‹λ§λ‹¤ 1κ° μ΄μƒμ μ‘λ‹µμ„ μƒμ„±ν•  μ μλ‹¤.

##### λ°μ΄ν„° κ²€μ¦
- λ¨λΈ μ„±λ¥μ— λ€ν• λ°μ΄ν„° ν’μ§μ μ¤‘μ”μ„±μ„ μƒκ°ν•  λ•, λ°μ΄ν„° ν’μ§μ„ κ²€μ¦ν•  λ°©λ²•μ„ κ°–λ” κ²ƒμ΄ μ¤‘μ”ν•λ‹¤.
- AI μƒμ„± λ°μ΄ν„°λ” λ‹¤λ¥Έ AI μ¶λ ¥μ„ ν‰κ°€ν•  λ•μ²λΌ κΈ°λ¥μ  μ¬λ°”λ¦„<small>functional correctness</small>κ³Ό AI νμ‚¬λ¥Ό μ΄μ©ν•  μ μλ‹¤.

##### AI μƒμ„± λ°μ΄ν„°μ ν•κ³„
- <mark>AI μƒμ„± λ°μ΄ν„°λ” μ‚¬λ μƒμ„± λ°μ΄ν„°λ¥Ό μ™„μ „ν λ€μ²΄ν•  μ μ—†λ‹¤. ν’μ§ μ°¨μ΄, λ¨λ°©μ ν•κ³„, μ μ¬μ μΈ λ¨λΈ λ¶•κ΄΄, λ¶λ¶„λ…ν• λ°μ΄ν„° κ³„ν†µ λ•λ¬Έμ΄λ‹¤.</mark>

###### ν’μ  μ μ–΄
###### κ²‰λ³΄κΈ° ν‰λ‚΄
###### μ μ¬μ μΈ λ¨λΈ λ¶•κ΄΄
###### λ¶λ¶„λ…ν• λ°μ΄ν„° κ³„ν†µ

#### λ¨λΈ μ¦λ¥<small>Model Distillation</small>
- <mark>λ¨λΈ μ¦λ¥(aka μ§€μ‹ μ¦λ¥)<small>model distillation</small>λ” μ‘μ€ λ¨λΈ(ν•™μƒ)μ΄ ν° λ¨λΈ(μ„ μƒλ‹)μ„ ν‰λ‚΄λ‚΄λ„λ΅ ν›λ ¨ν•λ” κ²ƒμ„ μλ―Έν•λ‹¤.</mark> ([Hinton et al., 2015](https://arxiv.org/abs/1503.02531))

### λ°μ΄ν„° μ²λ¦¬
#### λ°μ΄ν„° κ²€μ‚¬
- λ°μ΄ν„° μ •λ³΄μ™€ ν†µκ³„λ¥Ό ν™•μΈν•λ‹¤.
- ν† ν° λ¶„ν¬λ¥Ό λ„ν‘λ΅ ν‘ν„ν•λ‹¤.
- μ£Όμ μ™€ μ–Έμ–΄ λ¶„ν¬λ¥Ό ν™•μΈν•λ‹¤.
- λ°μ΄ν„° μ¶μ², μ‹κ°„, λ°μ΄ν„° μ£Όμ„κ°€ λ“±μ„ λ„ν‘λ΅ ν‘ν„ν•λ‹¤.
- μμ κ°€ μ—¬λ¬ μ£Όμ„μ΄ μλ‹¤λ©΄ μ£Όμ„κ°€ κ°„ λ¶μΌμΉλ¥Ό κ³„μ‚°ν•λ‹¤.

#### λ°μ΄ν„° μ¤‘λ³µ μ κ±°
- <mark>μ¤‘λ³µ λ°μ΄ν„°λ” λ°μ΄ν„° λ¶„ν¬λ¥Ό κΈ°μΈκ²ν•κ³  λ¨λΈμ— νΈκ²¬μ„ λ§λ“¤μ–΄λ‚Ό μ μλ‹¤.</mark>
- μ¤‘λ³µμ€ ν…μ¤νΈ μ…‹ μ¤μ—Όμ„ μ λ°ν•  μ μλ‹¤.
- μ¤‘λ³µμ΄ λ¨λΈ μ„±λ¥μ— μν–¥μ„ μ£Όμ§€ μ•λ”λΌλ„ μ‹κ°„κ³Ό κ³„μ‚°μ„ λ‚­λΉ„ν•  μ μλ‹¤.

#### λ°μ΄ν„° μ²­μ† λ° ν•„ν„°
- λ¨λΈ μ„±λ¥ ν–¥μƒκ³Ό μ•μ „μ„±μ„ μ„ν•΄ λ°μ΄ν„° μ²­μ†κ°€ ν•„μ”ν•λ‹¤.

#### λ°μ΄ν„° ν•μ‹ λ§μ¶”κΈ°

### μ”μ•½



<style>
table {
    margin: auto;
}
</style>