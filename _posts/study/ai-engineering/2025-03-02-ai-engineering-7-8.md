---
layout: post
title: "AI Engineering: Chapter 7, 8"
date: 2025-03-02 12:00:00 +0900
categories: study ai-engineering
comments: true
visible: true
---
[AI Engineering by Chip Huyen](https://www.oreilly.com/library/view/ai-engineering/9781098166298/)

## Chapter 7
Finetuning: νμΈνλ‹

- <mark>νμΈνλ‹μ€ λ¨λΈμ μ „μ²΄ λλ” μΌλ¶€λ¥Ό μ¶”κ°€μ μΌλ΅ ν•™μµμ‹μΌμ„ νΉμ • μ‘μ—…μ— μ μ‘<small>adapt</small>μ‹ν‚¤λ” κ³Όμ •μ„ λ§ν•λ‹¤.</mark>
    - λ¨λΈμ κ°€μ¤‘μΉλ¥Ό μ΅°μ •ν•λ‹¤.
- λ¨λΈμ λ„λ©”μΈ νΉν™” κΈ°λ¥μ„ ν–¥μƒμ‹ν‚¬ μ μλ‹¤.
    - μ½”λ”©μ΄λ‚ μν•™ μ§μμ‘λ‹µ
- λ¨λΈμ μ•μ „μ„±μ„ κ°•ν™”ν•  μ μλ‹¤.
- λ€λ¶€λ¶„ λ¨λΈμ μ§€μ‹ μν–‰ λ¥λ ¥μ„ ν–¥μƒμ‹ν‚¤λ”λ° μ‚¬μ©λλ‹¤. νΉν νΉμ • μ¶λ ¥ μ¤νƒ€μΌμ΄λ‚ ν•μ‹μ— μ¤€μν•λ„λ΅ ν•κΈ° μ„ν•΄ ν™μ©λλ‹¤.
- μ–Έμ  νμΈνλ‹ λλ” RAGλ¥Ό ν•΄μ•Όν• μ§€λ” ν”ν• μ§λ¬Έμ΄λ‹¤.
- ν”„λ΅¬ν”„νΈ κΈ°λ° λ°©λ²•κ³Ό λ‹¤λ¥΄κ² <mark>νμΈνλ‹μ€ ν›¨μ”¬ λ§μ€ λ©”λ¨λ¦¬ λ°μκµ­</mark>μ„ μ λ°ν•λ‹¤.
    - λ§μ€ νμΈνλ‹ κΈ°μ λ“¤μ€ λ©”λ¨λ¦¬ μ”κµ¬λ‰μ„ μ¤„μ΄λ” κ²ƒμ— μ°©μ•ν•μ—¬ κ°λ°λλ‹¤.
- <mark><i>PEFT</i><small>parameter-efficient finetunig</small>λ” λ©”λ¨λ¦¬ ν¨μ¨μ μΈ μ ‘κ·Ό</mark>μΌλ΅ νμΈνλ‹ μμ—­μ—μ„ μ§€λ°°μ μ΄λμ—λ‹¤.
    - PEFTμ—μ„λ” νΉν adpater-based κΈ°μ μ„ μ‚΄ν΄λ³Έλ‹¤.

### νμΈνλ‹ κ°μ”
- νμΈνλ‹μ€ ν•„μ”ν• λ¥λ ¥μ„ κ°€μ§„ λ² μ΄μ¤ λ¨λΈλ΅ μ‹μ‘ν•λ‹¤.
- <mark>νμΈνλ‹μ λ©ν‘λ” λ² μ΄μ¤ λ¨λΈμ„ νΉμ • μ‘μ—…μ„ λ” μ μν–‰ν•λ„λ΅ λ§λ“λ” κ²ƒμ΄λ‹¤.</mark>
- νμΈνλ‹μ€ μ „μ΄ ν•™μµ<small>transfer learning</small>μ ν• λ°©λ²•μ΄λ‹¤.
    - μ „μ΄ ν•™μµμ€ Bozinovβ€skiμ™€ Fulgosiμ— μν•΄ 1976λ…„ μ²μ μ†κ°λμ—λ‹¤.
    - μ „μ΄ ν•™μµμ€ ν• μ‘μ—…μ—μ„ μ–»μ–΄μ§„ μ§€μ‹μ„ μƒλ΅μ΄ μ‘μ—…μ ν•™μµ κ°€μ†μ„ μ„ν•΄ μ „μ΄ν•λ” λ°©λ²•μ— μ§‘μ¤‘ν•λ‹¤.
    - ν”Όμ•„λ…Έλ¥Ό μΉ  μ¤„ μ•„λ” μ‚¬λμ΄ λ‹¤λ¥Έ μ•…κΈ°λ¥Ό λ” μ‰½κ² λ‹¤λ£¨λ” κ²ƒκ³Ό λΉ„μ·ν•λ‹¤.
- λ”¥λ¬λ‹ μ΄μ°½κΈ° λ™μ• μ „μ΄ ν•™μµμ€ μ ν•λκ±°λ‚ κ°’λΉ„μ‹Ό ν›λ ¨ λ°μ΄ν„°λ¥Ό μ§€λ‹ μ‘μ—…μ— λ€ν• ν•΄κ²°μ±…μ„ μ μ‹ν–λ‹¤.
- LLMμ—μ„ ν…μ¤νΈ μ™„μ„±μ„ μ„ν• μ‚¬μ „ ν•™μµμ—μ„ μ–»μ–΄μ§„ μ§€μ‹μ€ νΉν™”λ μ‘μ—…μΈ λ²•λ¥  μ§μμ‘λ‹µμ΄λ‚ text-to-SQLλ΅ μ „μ΄λ  μ μλ‹¤.
    - μ „μ΄ ν•™μµμ λ¥λ ¥μ€ νμ΄λ°μ΄μ… λ¨λΈμ„ λ” κ°€μΉμκ² λ§λ“¤ μ μλ‹¤.
- <mark>μ „μ΄ ν•™μµμ€ μƒν” ν¨μ¨μ„±<small>sample efficiency</small>λ¥Ό ν–¥μƒμ‹ν‚¤κ³  λ¨λΈμ€ λ” μ μ€ μμ λ΅ κ°™μ€ ν–‰λ™μ„ ν¨κ³Όμ μΌλ΅ λ°°μ°κ² ν•  μ μλ‹¤.</mark>
    - μλ¥Ό λ“¤μ–΄, λ²•λ¥  μ§μμ‘λ‹µ λ¨λΈμ„ μ²μλ¶€ν„° λ§λ“λ ¤λ©΄ 100λ§κ°μ μμ κ°€ ν•„μ”ν•κ² μ§€λ§, μΆ‹μ€ λ² μ΄μ¤ λ¨λΈμ„ νμΈνλ‹ν•  λ•λ” μλ°±κ°μ μμ λ΅ μ¶©λ¶„ν•λ‹¤.
- <mark>μ΄μƒμ μΌλ΅ λ³΄λ©΄, λ¨λΈμ΄ λ°°μ›μ•Ό ν•  λ§μ€ λ‚΄μ©μ€ μ΄λ―Έ λ² μ΄μ¤ λ¨λΈμ— ν¬ν•¨λμ–΄ μμΌλ©°, νμΈνλ‹μ€ λ¨λΈμ ν–‰λ™μ„ λ‹¤λ“¬λ” μ—­ν• μ„ ν•λ‹¤.</mark>
    - OpenAIμ [InstructGPT (2022)](https://arxiv.org/abs/2203.02155)μ—μ„λ” λ¨λΈμ΄ μ΄λ―Έ κ°€μ§€κ³  μμΌλ‚ μ‚¬μ©μλ“¤μ΄ ν”„λ΅¬ν”„ν…λ§μΌλ΅λ” μ ‘κ·Όν•κΈ° μ–΄λ ¤μ΄ λ¥λ ¥μ„ νμΈνλ‹μ΄ μ κΈ ν•΄μ ν•λ‹¤λ” κ΄€μ μ„ μ μ•ν•λ‹¤.
<aside mark="π’΅">
μ „μ΄ ν•™μµμ€ νμΈνλ‹ λΏλ§ μ•„λ‹λΌ νΉμ§• κΈ°λ° μ „μ΄<small>feature-based transfer</small>λ΅λ„ κ°€λ¥ν•λ‹¤.<br/>
νΉμ§• κΈ°λ° μ „μ΄μ—μ„λ” λ¨λΈμ΄ λ°μ΄ν„°λ΅λ¶€ν„° νΉμ§•μ„ μ¶”μ¶ν•κ³  λ‹¤λ¥Έ λ¨λΈμ—μ„ μ΄λ¥Ό μ΄μ©ν•λ‹¤.<br/>
νΉμ§• κΈ°λ° μ „μ΄μ μλ΅, νμ΄λ°μ΄μ… λ¨λΈμ€ λ¶„λ¥ ν—¤λ“<small>classifier head</small>λ¥Ό μ¶”κ°€ν•μ—¬ λ¶„λ¥ μ‘μ—…μ— μ¬μ‚¬μ©λ  μ μλ‹¤.
</aside>
- νμΈνλ‹μ€ λ¨λΈ ν•™μµ κ³Όμ •μ μΌλ¶€μ΄λ©°, μ‚¬μ „ ν•™μµμ ν™•μ¥μ΄λ‹¤.
    - νμΈνλ‹μ€ μ‚¬μ „ ν•™μµ μ΄ν›„μ λ¨λ“  ν›λ ¨μ„ μλ―Έν•λ‹¤.
- λ¨λΈ ν›λ ¨ κ³Όμ •μ€ μ‚¬μ „ ν•™μµμΌλ΅ μ‹μ‘λλ©° μκΈ° μ§€λ„<small>self-supervision</small>λ΅ μ΄λ£¨μ–΄μ§„λ‹¤.
    - μκΈ° μ§€λ„λ” λ¨λΈμ΄ λ μ΄λΈ”λμ§€ μ•μ€ λ‹¤λ‰μ λ°μ΄ν„°λ΅λ¶€ν„° ν•™μµν•  μ μλ„λ΅ ν•λ‹¤.
    - μ–Έμ–΄ λ¨λΈμ—μ„ μκΈ° μ§€λ„ λ°μ΄ν„°λ” μ£Όμ„μ΄ ν•„μ”μ—†λ” ν…μ¤νΈμ λ‚μ—΄μ„ μλ―Έν•λ‹¤.
- <mark>κ°’λΉ„μ‹Ό μ‘μ—… νΉν™” λ°μ΄ν„°λ΅ νμΈνλ‹ν•κΈ° μ „μ—, μ €λ ΄ν• μ‘μ—… μ—°κ΄€ λ°μ΄ν„°λ΅ μκΈ° μ§€λ„ νμΈνλ‹μ„ ν•  μ μλ‹¤.</mark>
    - μλ¥Ό λ“¤μ–΄, λ²•λ¥  μ§μμ‘λ‹µμ κ²½μ° λ‚  κ²ƒμ λ²•λ¥  λ¬Έμ„λ΅ νμΈνλ‹ν•  μ μλ‹¤.
    - λ¨λΈμ΄ λ² νΈλ‚¨μ–΄λ΅ μ±… μ”μ•½μ„ ν•λ„λ΅ νμΈνλ‹ν•λ ¤λ©΄ λ§μ€ λ² νΈλ‚¨μ–΄ ν…μ¤νΈλ΅ λ¨Όμ € μΈνλ‹ν•  μ μλ‹¤.
- μκΈ° μ§€λ„ νμΈνλ‹<small>self-supervised finetuning</small>μ€ μ—°μ† μ‚¬μ „ ν•™μµ<small>continued pre-traning</small>μ΄λΌκ³ λ„ λ¶λ¦°λ‹¤.
- μ§€λ„ νμΈνλ‹<small>supervised finetuning</small>μ„ ν†µν•΄ λ¨λΈμ΄ λ‹¤μ ν† ν°μ΄λ‚ λΉ μΉΈμ„ μ±„μ°λ„λ΅ νμΈνλ‹ν•  μ μλ‹¤.
    - ν›„μλ” λΉ μΉΈ μ±„μ°κΈ° νμΈνλ‹<small>infilling finetuning</small>μ΄λ©° ν…μ¤νΈ νΈμ§‘μ΄λ‚ μ½”λ“ λ””λ²„κΉ… κ°™μ€ μ‘μ—…μ— νΉν μ μ©ν•λ‹¤. 
    - λ¨λΈμ΄ μκΈ°νκ·€μ <small>autoregressively</small>μΌλ΅ μ‚¬μ „ ν•™μµλμ—λ”λΌλ„ λΉ μΉΈ μ±„μ°κΈ° νμΈνλ‹μ„ ν•  μ μλ‹¤.
- <mark>μ§€λ„ νμΈνλ‹μ€ κ³ ν’μ§μ μ£Όμ„μ΄ λ‹¬λ¦° λ°μ΄ν„°λ¥Ό μ‚¬μ©ν•μ—¬ λ¨λΈμ„ μΈκ°„μ μ‚¬μ© λ°©μ‹κ³Ό μ„ νΈλ„μ— λ§κ² λ‹¤λ“¬λ”λ‹¤.</mark>
- <mark>μ§€λ„ νμΈνλ‹ λ™μ• λ¨λΈμ€ (μ…λ ¥, μ¶λ ¥) μμΌλ΅ ν›λ ¨λλ‹¤.</mark>
    - μ…λ ¥μ€ μ§€μ‹, μ¶λ ¥μ€ λ‹µλ³€μ΄ λ  μ μλ‹¤.
- λ‹µλ³€μ€ μ±… μ”μ•½μ²λΌ μ—΄λ¦° κ²°λ§<small>open-ended</small>μ΄κ±°λ‚ λ¶„λ¥ μ‘μ—…μ²λΌ λ‹«ν κ²°λ§<small>close-ended</small>μΌ μ μλ‹¤.
- κ³ ν’μ§ μ§€μ‹ λ°μ΄ν„°λ” λ§λ“¤κΈ° μ–΄λ µκ³  λΉ„μ€ μ μλ‹¤. νΉν μ‚¬μ‹¤μ  μΌκ΄€μ„±, λ„λ©”μΈ μ „λ¬Έκ°€, μ •μΉμ  μ¬λ°”λ¦„μ„ μ”κµ¬ν•λ” μ§€μ‹μΌ κ²½μ° λ” κ·Έλ ‡λ‹¤.
- <mark>λ¨λΈμ€ μ‚¬λμ μ„ νΈλ„λ¥Ό μµλ€ν™”ν•  μ μλ” λ‹µλ³€μ„ μƒμ„±ν•λ„λ΅ κ°•ν™” ν•™μµμΌλ΅ νμΈνλ‹λ  μ μλ‹¤.</mark>
    - <mark>μ„ νΈλ„ νμΈνλ‹<small>preference finetuning</small>μ€ μ£Όλ΅ (μ§€μ‹, μ΄κΈ΄ λ‹µλ³€, μ§„ λ‹µλ³€)μ ν•μ‹μ„ λ”°λ¥΄λ” λΉ„κµ λ°μ΄ν„°λ¥Ό ν•„μ”λ΅ ν•λ‹¤.</mark>
- <mark>μ»¨ν…μ¤νΈ κΈΈμ΄λ¥Ό λλ¦¬κΈ° μ„ν•΄ λ¨λΈμ„ νμΈνλ‹ν•  μ μλ‹¤.</mark>
    - κΈ΄ μ»¨ν…μ¤νΈ νμΈνλ‹<small>long-context finetuning</small>μ€ μ£Όλ΅ λ¨λΈμ κµ¬μ΅°λ¥Ό μμ •ν•  ν•„μ”κ°€ μλ‹¤. μΌλ΅€λ΅, μ„μΉ μ„λ² λ”©<small>positional embedding</small>μ„ μ΅°μ •ν•΄μ•Ό ν•λ‹¤.
    - κΈ΄ μ‹ν€€μ¤λ” ν† ν°μ΄ λ” λ§μ€ κ°€λ¥ν• μ„μΉλ¥Ό κ°€μ§„λ‹¤λ” κ²ƒμ΄κ³ , μ„μΉ μ„λ² λ”©μ€ μ΄λ¥Ό μ²λ¦¬ν•  μ μμ–΄μ•Ό ν•λ‹¤.
    - κΈ΄ μ»¨ν…μ¤νΈ νμΈνλ‹μ€ λ‹¤λ¥Έ νμΈνλ‹λ³΄λ‹¤ μν–‰ν•κΈ° μ–΄λ µκ³ , κ²°κ³Ό λ¨λΈμ€ μ§§μ€ μ‹ν€€μ¤μ— λ€ν•΄ ν’μ§μ΄ μ €ν•λ  μ μλ‹¤.
- λ¨λΈ κ°λ°μλ” λ‹¤λ¥Έ λ©μ μΌλ΅ νμΈνλ‹λ μ—¬λ¬ λ¨λΈ λ²„μ „μ„ μ¶μ‹ν•  μ μμΌλ©°, μ• ν”λ¦¬μΌ€μ΄μ… κ°λ°μλ” μ ν•©ν• λ¨λΈμ„ μ„ νƒν•  μ μλ‹¤.

<div style="text-align: center;"><img src="{{ "/assets/img/posts/study/ai-engineering/chapter7-8/figure7-1.png" | relative_url }}" width="540px"/><p>Code Llama λ¨λΈμ— μ μ©λ μ—¬λ¬ νμΈνλ‹ κΈ°μ λ“¤</p></div>

### μ–Έμ  νμΈνλ‹μ„ ν•΄μ•Όν• κΉ?
#### νμΈνλ‹ν•  μ΄μ 
#### νμΈνλ‹ν•μ§€ μ•μ„ μ΄μ 
#### νμΈνλ‹κ³Ό RAG

### λ©”λ¨λ¦¬ λ³‘λ©
#### μ—­μ „νμ™€ ν›λ ¨ κ°€λ¥ν• νλΌλ―Έν„°
#### λ©”λ¨λ¦¬ μ‚¬μ©λ‰ κ³„μ‚°
#### μ ν‘ν„<small>Numerical Presentations</small>
#### μ–‘μν™”<small>Quantization</small>

### νμΈνλ‹ κΈ°μ 
#### νλΌλ―Έν„° ν¨μ¨μ μΈ νμΈνλ‹<small>Parameter-Efficent Finetuning</small>
#### λ¨λΈ λ³‘ν•©κ³Ό λ‹¤μ¤‘ μ‘μ—… νμΈνλ‹
#### νμΈνλ‹ μ „λµ

### μ”μ•½

## Chatper 8
Dateset Engineering: λ°μ΄ν„°μ…‹ μ—”μ§€λ‹μ–΄λ§

### λ°μ΄ν„° μ„ λ³„<small>Data Curation</small>
#### λ°μ΄ν„° ν’μ§
#### λ°μ΄ν„° ν¬κ΄„μ„±<small>Data Coverage</small>
#### λ°μ΄ν„° μ–‘
#### λ°μ΄ν„° νλ“κ³Ό μ£Όμ„<small>Data Acquistion and Annotation</small>

### λ°μ΄ν„° μ¦κ°• λ° ν•©μ„±
#### μ™ λ°μ΄ν„° ν•©μ„±μ„ ν• κΉ?
#### μ „ν†µμ μΈ λ°μ΄ν„° ν•©μ„± κΈ°μ 
#### AI κΈ°λ° λ°μ΄ν„° ν•©μ„±
#### λ¨λΈ μ¦λ¥<small>Model Distillation</small>

### λ°μ΄ν„° μ²λ¦¬
#### λ°μ΄ν„° κ²€μ‚¬
#### λ°μ΄ν„° μ¤‘λ³µ μ κ±°
#### λ°μ΄ν„° μ§€μ°κΈ° λ° ν•„ν„°
#### λ°μ΄ν„° ν•μ‹ λ§μ¶”κΈ°

### μ”μ•½